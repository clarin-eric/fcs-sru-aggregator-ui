const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./fcs-sru-aggregator-ui-querybuilder.js","./vendor/react-ext.js","./vendor/react.js","./vendor/bootstrap.js","./vendor/antlr4.js","./locales/en/default.js","./vendor/prism.js","./fcs-sru-aggregator-ui-querybuilder.css","./vendor/bootstrap.css"])))=>i.map(i=>d[i]);
import{r as h,u as Ue,c as Ws,b as te,j as e,L as _e,T as W,d as Qs,e as kt,N as Ps,f as xe,g as Pt,h as Ot,H as Xe,R as Ht,k as Ut,l as Gs,m as Rs,n as Ls,o as Ys,p as ve,q as Dt,s as Ft,t as Bt,v as Xs,w as qt,x as Vt,y as ss,Q as $t,z as zt,A as Kt,B as Wt,C as Qt}from"./vendor/react-ext.js";import{b as Gt}from"./vendor/react.js";/* empty css                      */import{C as ie,R as X,a as H,N as Ie,b as ce,c as ts,d as E,B as fe,M as se,F as $,e as Z,T as Je,f as De,g as Js,h as Re,I as Yt,D as oe,S as Zs,i as re,O as Me,j as Fe,L as Qe,A as de,P as ns,k as hs,l as Xt,m as ms,n as ze}from"./vendor/bootstrap.js";import{_ as et,a as st,b as Jt,c as Zt,d as en}from"./locales/en/default.js";import{g as sn}from"./vendor/prism.js";/*!
 * FCS SRU Aggragator UI
 * @module lib/fcs-sru-aggregator-ui.js
 * @version 1.0.0-alpha
 * @license GPL-3.0-or-later
 * @see {@link https://github.com/clarin-eric/fcs-sru-aggregator-ui.git}
 */(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();var rs={},Os;function tn(){if(Os)return rs;Os=1;var t=Gt();return rs.createRoot=t.createRoot,rs.hydrateRoot=t.hydrateRoot,rs}var nn=tn();const ae="x-consortia";async function rn(t,n){const s=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&s.set(ae,n.consortia);const r="init"+(s.entries().next().done?"":`?${s}`);return(await t.get(r)).data}async function ps(t,n){const s=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&s.set(ae,n.consortia);const r="resources"+(s.entries().next().done?"":`?${s}`);return(await t.get(r)).data}async function an(t,n){const s=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&s.set(ae,n.consortia);const r="languages"+(s.entries().next().done?"":`?${s}`);return(await t.get(r)).data}async function on(t,n){const s=new URLSearchParams;n?.consortia!==void 0&&n?.consortia!==null&&s.set(ae,n.consortia);const r="statistics"+(s.entries().next().done?"":`?${s}`);return(await t.get(r)).data}async function ln(t,n){return(await t.post("search",n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function cn(t,n,s){return(await t.post(`search/${n}`,s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data}async function dn(t,n){if(!n)throw new Error('Invalid "searchID" parameter!');return(await t.get(`search/${n}/metaonly`)).data}async function un(t,n,s){if(!n)throw new Error('Invalid "searchID" parameter!');if(!s)throw new Error('Invalid "resourceID" parameter!');const i=(await t.get(`search/${n}/metaonly?resourceId=${encodeURIComponent(s)}`)).data.results.filter(a=>a.id===s);if(i.length===0)throw new Error(`Results (meta) for resource not found! (searchId: ${n}, resourceId: ${s})`);return i[0]}async function hn(t,n,s){if(!n)throw new Error('Invalid "searchID" parameter!');if(!s)throw new Error('Invalid "resourceID" parameter!');const i=(await t.get(`search/${n}?resourceId=${encodeURIComponent(s)}`)).data.results.filter(a=>a.resource.id===s);if(i.length===0)throw new Error(`Results for resource not found! (searchId: ${n}, resourceId: ${s})`);return i[0].records===void 0&&console.warn("Using legacy FCS SRU Aggregator API with Search Results not in '.records'!",{searchID:n},i),i[0]}function mn(t,n,s,r,i,a){const d=new URLSearchParams({resourceId:s,format:r});(a==="byGuess"||a==="byMetaAndGuess")&&d.set("filterLanguage",i);const l=`search/${n}/download?${d.toString()}`;return t.getUri({url:l})}function gn(t,n,s,r,i,a){const d=new URLSearchParams({resourceId:s});r?d.set("filterLanguage",r):(a==="byGuess"||a==="byMetaAndGuess")&&d.set("filterLanguage",i);const l=`search/${n}/toWeblicht?${d.toString()}`;return t.getUri({url:l})}const pn=[ae];function Hs(t){return t.entries().next().done?void 0:`?${t}`}function xn(){const[t]=Ue(),n=h.useMemo(()=>new URLSearchParams(Array.from(t.entries()).filter(([r])=>pn.includes(r))),[t]),s=h.useCallback(r=>{const i=new URLSearchParams(n);return Ws(r).forEach((a,d)=>i.append(d,a)),i},[n]);return[n,s]}function ke(){const[t,n]=xn(),s=Hs(t),r=h.useCallback(i=>Hs(n(i)),[n]);return[s,r]}function fn(){const{t}=te(),n="urls.termsUseAndDisclaimer",s=t(n,{ns:"common"}),r=s!==n,i="urls.contact",a=t(i,{ns:"common"}),d=a!==i,l="footer.serviceInfo.text",m=t(l)!==l,[g]=ke();return e.jsx("footer",{className:"text-muted",children:e.jsx(ie,{children:e.jsxs(X,{children:[e.jsxs(H,{className:"text-start d-flex flex-sm-row flex-column column-gap-3 row-gap-2",children:[e.jsxs("div",{children:[e.jsx(_e,{to:{pathname:"/about",search:g},className:"hidden-xs",children:t("footer.links.about")}),e.jsxs("div",{className:"version-info text-muted text-center-xs",children:["v","1.0.0-alpha"]})]}),e.jsx(_e,{to:{pathname:"/stats",search:g},children:t("footer.links.statistics")})]}),e.jsx(H,{className:"text-center",children:m&&e.jsx(W,{i18nKey:l,components:{serviceBy:e.jsx("a",{href:t("footer.serviceInfo.urlServiceBy")}),hostedBy:e.jsx("a",{href:t("footer.serviceInfo.urlHostedBy")})}})}),e.jsxs(H,{className:"hidden-xs text-end d-flex flex-sm-row flex-column justify-content-sm-end column-gap-3 row-gap-2",children:[r&&e.jsx("a",{href:s,children:t("footer.links.termsUseAndDisclaimer")}),d&&e.jsx("a",{href:a,children:t("footer.links.contact")})]})]})})})}const G=Qs(t=>({deployPath:"/fcs-sru-aggregator-ui",apiURL:"https://alpha-contentsearch.clarin.eu/rest/",validatorURL:"https://www.clarin.eu/fcsvalidator/",showSearchResultLink:!1,appTitle:"Content Search",appTitleHead:"FCS Aggregator â€“ Content Search",matomoTrackingEnabled:!0,matomoTrackingParams:null,authUsername:null,isAuthenticated:!1,setDeployPath:n=>t(s=>({deployPath:typeof n=="function"?n(s.deployPath):n})),setApiURL:n=>t(s=>({apiURL:typeof n=="function"?n(s.apiURL):n})),setValidatorURL:n=>t(s=>({validatorURL:typeof n=="function"?n(s.validatorURL):n})),setShowSearchResultLink:n=>t(s=>({showSearchResultLink:typeof n=="function"?n(s.showSearchResultLink):n})),setAppTitle:n=>t(s=>({appTitle:typeof n=="function"?n(s.appTitle):n})),setAppTitleHead:n=>t(s=>({appTitleHead:typeof n=="function"?n(s.appTitleHead):n})),setMatomoTrackingParams:n=>t(s=>({matomoTrackingParams:typeof n=="function"?n(s.matomoTrackingParams):n})),setAuthUsername:n=>t(s=>{const r=typeof n=="function"?n(s.authUsername):n;return{authUsername:r,isAuthenticated:r!==null&&r!=="anonymous"}})}));var jn=["en","de"];const ne=Qs(t=>({locale:"en",locales:jn??["en"],setLocale:n=>t(s=>({locale:typeof n=="function"?n(s.locale):n})),setLocales:n=>t(s=>({locales:typeof n=="function"?n(s.locales):n}))})),ge=t=>{const n=kt(ne,t);return Object.assign(n,ne),n},bn=""+new URL("assets/clarin-logo-wide.png",import.meta.url).href,yn=""+new URL("assets/icon-services-fcs.png",import.meta.url).href,xs=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
  <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
</svg>`,Be=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-translate" viewBox="0 0 16 16">
  <path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
  <path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
</svg>`;function wn(){const{t}=te(),n=ge(f=>f.locale),s=ge(f=>f.locales),r=ge(f=>f.setLocale),i=G.getState().authUsername,a=G.getState().isAuthenticated,d=G.getState().deployPath??"",l=d+(d.endsWith("/")?"":"/")+"login",[u]=ke(),m="urls.helpWithTranslations",g=t(m,{ns:"common"}),R=g!==m;function x(f){f!==null&&r(f)}function C(){return a?e.jsxs(Ie.Text,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:xs},className:"d-md-inline d-none"})," ",e.jsx(W,{i18nKey:"header.login.signedInAs",components:[e.jsx("span",{className:"fw-bold",children:i})]})]}):e.jsxs(ce.Link,{href:`${l}${u??""}`,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:xs},className:"d-md-inline d-none"})," ",t("header.login.login")]})}function y(){if(!s||s.length===1)return null;const f=new Intl.DisplayNames([n,"en"],{type:"language"}),b=e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Be},className:"d-md-inline d-none"}),e.jsx("span",{className:"d-inline d-md-none",children:t("header.localeLabelOnMobile")})," ",n.toUpperCase()," "]});return e.jsxs(ts,{title:b,align:"end",className:"ms-md-2",onSelect:x,children:[s.map(_=>{const j=new Intl.DisplayNames([_,"en"],{type:"language"});return e.jsxs(ts.Item,{disabled:_===n,"aria-disabled":_===n,eventKey:_,title:t("header.localeOptionTitle",{code:_,name:j.of(_),context:_!==n?"translated":null,translated:f.of(_)}),children:[_.toUpperCase()," â€“ ",j.of(_)]},_)}),R&&e.jsxs(e.Fragment,{children:[e.jsx(ts.Divider,{}),e.jsx(ts.Item,{className:"matomo_link text-wrap",target:"_blank",href:g,onClick:_=>_.stopPropagation(),children:t("header.localeHelpWithTranslations")})]})]})}function N(){return e.jsx(Ie.Brand,{className:"ms-md-4",children:e.jsx("img",{src:bn,alt:t("header.appLogoAlt"),height:30,className:"d-inline-block align-top",onError:({currentTarget:f})=>{console.warn("Logo not found!"),f.onerror=null,f.parentElement.style.display="none"}})})}return e.jsx("header",{children:e.jsx(Ie,{expand:"md",className:"bg-body-tertiary",children:e.jsxs(ie,{children:[e.jsxs(Ie.Brand,{as:_e,to:{pathname:"/",search:u},children:[e.jsx("img",{src:yn,width:"30",height:"30",className:"d-inline-block align-top",alt:`${t("header.title")} logo`})," ",t("header.title")]}),e.jsx(Ie.Toggle,{"aria-controls":"header-navbar-nav"}),e.jsx(Ie.Collapse,{id:"header-navbar-nav",children:e.jsxs(ce,{className:"w-100 d-flex",children:[e.jsx(ce.Link,{as:Ps,to:{pathname:"/",search:u},children:t("header.menu.home")}),e.jsx(ce.Link,{as:Ps,to:{pathname:"/help",search:u},children:t("header.menu.help")}),e.jsx(Ie.Text,{className:"ms-auto d-md-block d-none"}),C(),y(),N()]})})]})})})}/*!
 * Color mode switcher based on example from Bootstrap 5 docs.
 * @see https://getbootstrap.com/docs/5.3/customize/color-modes/#javascript
 */function vn(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Sn(t){t==="auto"?document.documentElement.setAttribute("data-bs-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):document.documentElement.setAttribute("data-bs-theme",t)}function Rn(){h.useEffect(()=>{function t(){Sn(vn())}return t(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t),()=>window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",t)},[])}const Ln="modulepreload",Nn=function(t,n){return new URL(t,n).href},Us={},le=function(n,s,r){let i=Promise.resolve();if(s&&s.length>0){let m=function(g){return Promise.all(g.map(R=>Promise.resolve(R).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const d=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");i=m(s.map(g=>{if(g=Nn(g,r),g in Us)return;Us[g]=!0;const R=g.endsWith(".css"),x=R?'[rel="stylesheet"]':"";if(!!r)for(let N=d.length-1;N>=0;N--){const f=d[N];if(f.href===g&&(!R||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${x}`))return;const y=document.createElement("link");if(y.rel=R?"stylesheet":Ln,R||(y.as="script"),y.crossOrigin="",y.href=g,u&&y.setAttribute("nonce",u),document.head.appendChild(y),R)return new Promise((N,f)=>{y.addEventListener("load",N),y.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(d){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=d,window.dispatchEvent(l),!l.defaultPrevented)throw d}return i.then(d=>{for(const l of d||[])l.status==="rejected"&&a(l.reason);return n().catch(a)})},Cn=(t,n,s)=>{const r=t[n];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+n+(n.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})},In={en:{app:st,common:et}},fs="clarin",Tn=ne.getInitialState().locale,_n=ne.getInitialState().locales;function An(t,n){if(!t)return n;const s=typeof t=="string"?[t]:t;return[...s.map(i=>`${fs}.${i}`),...s]}const js=["app","common"],En=An(js);function is(t){return typeof t=="string"||!Array.isArray(t)?[String(t)]:t}function Mn(t,n,s,r){if(s?.postProcessTryPrefixedNamespacesFirst!==void 0)return t;const i=is(n),a=is(s.ns||r.options.defaultNS||[]),d=r.resolve(i,s),u=(d?.res!==void 0?[...is(s.ns||[]),d.usedNS]:[...is(s.ns||[]),...a]).map(g=>g.startsWith(fs)?g:`${fs}.${g}`),m=r.translate(i,{...s,ns:u,postProcessTryPrefixedNamespacesFirst:!0});return i.includes(m)?t:m}xe.use(Pt).use({type:"postProcessor",name:"try-prefixed-namespaces-first",process:Mn}).use(Ot((t,n)=>Cn(Object.assign({"../locales/de/app.json":()=>le(()=>import("./locales/de/default.js").then(r=>r.a),[],import.meta.url),"../locales/de/clarin.app.json":()=>le(()=>import("./locales/de/default.js").then(r=>r.c),[],import.meta.url),"../locales/de/common.json":()=>le(()=>import("./locales/de/default.js").then(r=>r.b),[],import.meta.url),"../locales/de/textplus.app.json":()=>le(()=>import("./locales/de/textplus.app.js"),[],import.meta.url),"../locales/en/app.json":()=>le(()=>import("./locales/en/default.js").then(r=>r.e),[],import.meta.url),"../locales/en/clarin.app.json":()=>le(()=>import("./locales/en/default.js").then(r=>r.g),[],import.meta.url),"../locales/en/clarin.common.json":()=>le(()=>import("./locales/en/default.js").then(r=>r.h),[],import.meta.url),"../locales/en/common.json":()=>le(()=>import("./locales/en/default.js").then(r=>r.f),[],import.meta.url),"../locales/en/querybuilder.json":()=>le(()=>import("./locales/en/querybuilder.js"),[],import.meta.url),"../locales/en/querysuggestions.json":()=>le(()=>import("./locales/en/default.js").then(r=>r.q),[],import.meta.url),"../locales/en/textplus.app.json":()=>le(()=>import("./locales/en/textplus.app.js"),[],import.meta.url),"../locales/en/textplus.common.json":()=>le(()=>import("./locales/en/textplus.common.js"),[],import.meta.url)}),`../locales/${t}/${n}.json`,4))).init({lng:Tn,fallbackLng:"en",supportedLngs:_n,ns:En,defaultNS:js,fallbackNS:js,debug:!1,interpolation:{escapeValue:!1},postProcess:["try-prefixed-namespaces-first"],resources:In,partialBundledLanguages:!0,react:{nsMode:"fallback",transKeepBasicHtmlNodesFor:["br","strong","i","p","em","kbd","code"]}});xe.addResourceBundle("en","clarin.app",Jt);xe.addResourceBundle("en","clarin.common",Zt);xe.addResourceBundle("en","app",st);xe.addResourceBundle("en","querysuggestions",en);xe.addResourceBundle("en","common",et);Object.assign(window,{i18n:xe});function kn(t){let n=null;const s=document.body;function r(){n=document.createElement("script"),n.src=t,n.async=!0,s.appendChild(n)}function i(){n!==null&&s.removeChild(n)}return[r,i]}function Pn(t,{delay:n=void 0}={}){h.useEffect(()=>{if(!t)return;const[s,r]=kn(t);let i;return n!==void 0&&n>0?i=setTimeout(()=>{s()},n):s(),()=>{i!==void 0&&clearTimeout(i),r()}},[t,n])}function On(t,n=0){let s=3735928559^n,r=1103547991^n;for(let i=0,a;i<t.length;i++)a=t.charCodeAt(i),s=Math.imul(s^a,2654435761),r=Math.imul(r^a,1597334677);return s=Math.imul(s^s>>>16,2246822507),s^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(s^s>>>13,3266489909),4294967296*(2097151&r)+(s>>>0)}window._paq=window._paq||[];function Hn({siteId:t,trackerUrl:n,enableLinkTracking:s=!0,domains:r=[],userId:i=void 0}){window._paq.push(["setTrackerUrl",n]),window._paq.push(["setSiteId",t]),i&&window._paq.push(["setUserId",i]),Array.isArray(r)&&r.length>0&&window._paq.push(["setDomains",r]),s&&(window._paq.push(["enableLinkTracking"]),window._paq.push(["setLinkTrackingTimer",250]))}function Un({srcUrl:t}){const n=document.createElement("script"),s=document.getElementsByTagName("script")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.src=t,s&&s.parentNode&&s.parentNode.insertBefore(n,s)}function tt(t){if(!t)return null;let n=null;if(typeof t=="string")try{n=JSON.parse(t)}catch(s){return console.error("Error trying to parse tracking params!",s),null}else typeof t=="object"&&(n=t);if(n&&!Object.hasOwn(n,"indexUrl")&&Object.hasOwn(n,"srcUrl")){const i=`${n.srcUrl.split("/").slice(0,-1).join("/")}/index.php`;n.indexUrl=i}return n}function Dn(t){const n=tt(t);if(n===null)return!1;const s=n.siteId,r=n.trackerUrl,i=n.srcUrl,a=n.domains,d=n.userId?.toString();if(i===void 0)return console.warn('No "srcUrl" configuration set for tracking!'),!1;if(r===void 0)return console.warn('No "trackerUrl" configuration set for tracking!'),!1;if(s===void 0||!Number.isInteger(s))return console.warn('No "siteId" configuration set for tracking!'),!1;const l={siteId:s,trackerUrl:r,domains:a};d&&(l.userId=On(d).toString());const u={srcUrl:i};return Hn(l),nt(document.location.href||window.location.href,document.title),Un(u),!0}function nt(t,n,s){window._paq.push(["setDocumentTitle",n??document.title]),window._paq.push(["setCustomUrl",t]),s!==void 0&&window._paq.push(["setReferrerUrl",s]),window._paq.push(["trackPageView"])}function rt(t,n=!1,s=!1){window._paq.push(["trackSiteSearch",t,n,s])}const Fn=["Emanuel Dima","Erik KÃ¶rner","Leif-JÃ¶ran Olsson","Yana Panchenko","Oliver Schonefeld","Dieter Van Uytvanck"],Bn=[{id:"react",name:"React",url:"https://react.dev/",license:"MIT License",licenseUrl:"https://github.com/facebook/react/blob/main/LICENSE"},{id:"react-dom",name:"ReactDOM",url:"https://react.dev/reference/react-dom",license:"MIT License",licenseUrl:"https://github.com/facebook/react/blob/main/LICENSE",hide:!0},{id:"react-router",name:"React Router",url:"https://reactrouter.com/",license:"MIT License",licenseUrl:"https://github.com/remix-run/react-router/blob/main/LICENSE.md",usage:"single page application routing"},{id:"react-bootstrap",name:"React Bootstrap",url:"https://react-bootstrap.netlify.app/",license:"MIT License",licenseUrl:"https://github.com/react-bootstrap/react-bootstrap/blob/master/LICENSE",usage:"react bindings for bootstrap"},{id:"bootstrap",name:"Bootstrap",url:"https://getbootstrap.com/",license:"MIT License",licenseUrl:"https://github.com/twbs/bootstrap/blob/main/LICENSE",usage:"UI framework"},{id:"bootstrap-icons",name:"Bootstrap Icons",url:"https://icons.getbootstrap.com/",license:"MIT License",licenseUrl:"https://github.com/twbs/icons/blob/main/LICENSE"},{id:"@tanstack/react-query",name:"TanStack Query",url:"https://tanstack.com/query",license:"MIT License",licenseUrl:"https://github.com/TanStack/query/blob/main/LICENSE",usage:"data loading via REST APIs"},{id:"axios",name:"Axios",url:"https://axios-http.com/",license:"MIT License",licenseUrl:"https://github.com/axios/axios/blob/v1.x/LICENSE",usage:"cross-browser support for REST API requests"},{id:"antlr4ng",name:"Next Generation TypeScript runtime for ANTLR4",url:"https://github.com/mike-lischke/antlr4ng",license:'The "BSD license"',licenseUrl:"https://github.com/mike-lischke/antlr4ng/blob/main/LICENSE.txt",usage:"query parser"},{id:"i18next",name:"i18next",url:"https://www.i18next.com/",license:"MIT License",licenseUrl:"https://github.com/i18next/i18next/blob/master/LICENSE",usage:"translations"},{id:"react-i18next",name:"react-i18next",url:"https://react.i18next.com/",license:"MIT License",licenseUrl:"https://github.com/i18next/react-i18next/blob/master/LICENSE",usage:"translations",hide:!0},{id:"i18next-resources-to-backend",name:"i18next-resources-to-backend",url:"https://github.com/i18next/i18next-resources-to-backend",license:"MIT License",licenseUrl:"https://github.com/i18next/i18next-resources-to-backend/blob/main/licence",usage:"translation resource loading",hide:!0},{id:"zustand",name:"Zustand",url:"https://zustand-demo.pmnd.rs/",license:"MIT License",licenseUrl:"https://github.com/pmndrs/zustand/blob/main/LICENSE",usage:"state management"},{id:"@nozbe/microfuzz",name:"microfuzz",url:"https://github.com/Nozbe/microfuzz",license:"MIT License",licenseUrl:"https://github.com/Nozbe/microfuzz/blob/main/LICENSE",usage:"fuzzy search"},{id:"react-helmet-async",name:"React Helmet (async fork)",url:"https://github.com/staylor/react-helmet-async",license:"Apache License 2.0",licenseUrl:"https://github.com/staylor/react-helmet-async/blob/main/LICENSE",usage:"HTML head modifications"},{id:"react-slugify",name:"react-slugify",url:"https://github.com/martpie/react-slugify",license:"MIT License",licenseUrl:"https://github.com/martpie/react-slugify/blob/master/LICENSE",usage:"jump id fragment generation"}];function qn(){const{t}=te(),n=ge(y=>y.locale),s="urls.termsUseAndDisclaimer",r=t(s,{ns:"common"}),i=r!==s,a=G.getState().matomoTrackingEnabled,d=tt(G.getState().matomoTrackingParams)?.indexUrl,l=d?`${d}?module=CoreAdminHome&action=optOutJS&language=auto&div=matomo-opt-out`:null;Pn(l,{delay:300});const u=G.getState().appTitleHead,[m]=ke(),R=void 0;function x(y){return e.jsx("ul",{children:y.filter(N=>N.hide!==!0).map(N=>e.jsxs("li",{children:[N.url?e.jsx("a",{href:N.url,children:N.name}):e.jsx("span",{children:N.name}),N.license&&e.jsxs(e.Fragment,{children:[" ","(",N.licenseUrl?e.jsx("a",{href:N.licenseUrl,children:N.license}):e.jsx("span",{children:N.license}),")"]})]},N.id))})}function C(y){const N=Date.parse(y);return Intl.DateTimeFormat(n,{dateStyle:"medium",timeStyle:"long"}).format(N)}return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{children:e.jsxs("title",{children:[u," â€“ About"]})}),e.jsxs(ie,{className:"py-4",children:[e.jsx("h1",{className:"h1 mb-4",children:t("about.title")}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:t("about.people.title")}),e.jsx("p",{children:t("about.people.developedBy")}),e.jsx("ul",{children:Fn.map(y=>e.jsx("li",{children:y},y))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:t("about.statistics.title")}),e.jsx("p",{children:e.jsx(W,{i18nKey:"about.statistics.text",components:[e.jsx(_e,{to:{pathname:"/stats",search:m},children:"endpoint statistics"})]})})]}),(i||a)&&e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:t("about.privacyPolicy.title")}),i&&e.jsx("p",{children:e.jsx(W,{i18nKey:"about.privacyPolicy.termsInfo",components:[e.jsx("a",{href:r,children:"clarin.eu"})]})}),a&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:e.jsx(W,{i18nKey:"about.privacyPolicy.matomoInfo",components:[e.jsx("a",{href:"https://matomo.org/",children:"Matomo"})]})}),l&&e.jsx(E,{className:"mb-3",id:"matomo-opt-out-container",children:e.jsx(E.Body,{id:"matomo-opt-out"})})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:t("about.sourceCode.title")}),e.jsx("p",{children:e.jsx(W,{i18nKey:"about.sourceCode.sourceInfo.text",components:[e.jsx("a",{href:t("about.sourceCode.sourceInfo.repoUrl"),children:"GitHub"}),e.jsx("a",{href:t("about.sourceCode.sourceInfo.licenseUrl"),children:"GPL 3.0 license"})]})}),e.jsx("p",{children:t("about.sourceCode.licenseInfo")})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:t("about.versions.title")}),e.jsxs(X,{children:[R,e.jsxs(H,{md:12,lg:12,children:[R,e.jsxs("dl",{className:"",children:[e.jsx("dt",{children:t("about.versions.frontend.lblVersion")}),e.jsx("dd",{children:e.jsx("code",{children:"1.0.0-alpha"})}),e.jsx("dt",{children:t("about.versions.frontend.lblSHA")}),e.jsx("dd",{children:e.jsx("code",{children:"1170f21"})}),e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:t("about.versions.frontend.lblRef")}),e.jsx("dd",{children:e.jsx("code",{children:"main"})})]}),e.jsx("dt",{children:t("about.versions.frontend.lblDate")}),e.jsx("dd",{children:C("2025-09-03T16:54:16+02:00")})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"h2",children:t("about.technology.title")}),e.jsxs(X,{children:[R,e.jsxs(H,{md:12,lg:12,children:[e.jsx("p",{children:t("about.technology.frontendUses")}),x(Bn)]})]}),e.jsx("p",{children:e.jsx(W,{i18nKey:"about.technology.iconLicenseInfo",components:[e.jsx("a",{href:"http://www.freepik.com/",children:"Freepik"}),e.jsx("a",{href:"www.flaticon.com",children:"www.flaticon.com"}),e.jsx("a",{href:"http://creativecommons.org/licenses/by/3.0/",children:"CC BY 3.0"})]})})]})]})]})}const Ae=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
  <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
  <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
</svg>`,Ye=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-magic" viewBox="0 0 16 16">
  <path d="M9.5 2.672a.5.5 0 1 0 1 0V.843a.5.5 0 0 0-1 0zm4.5.035A.5.5 0 0 0 13.293 2L12 3.293a.5.5 0 1 0 .707.707zM7.293 4A.5.5 0 1 0 8 3.293L6.707 2A.5.5 0 0 0 6 2.707zm-.621 2.5a.5.5 0 1 0 0-1H4.843a.5.5 0 1 0 0 1zm8.485 0a.5.5 0 1 0 0-1h-1.829a.5.5 0 0 0 0 1zM13.293 10A.5.5 0 1 0 14 9.293L12.707 8a.5.5 0 1 0-.707.707zM9.5 11.157a.5.5 0 0 0 1 0V9.328a.5.5 0 0 0-1 0zm1.854-5.097a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L8.646 5.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0l1.293-1.293Zm-3 3a.5.5 0 0 0 0-.706l-.708-.708a.5.5 0 0 0-.707 0L.646 13.94a.5.5 0 0 0 0 .707l.708.708a.5.5 0 0 0 .707 0z"/>
</svg>`,it=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
</svg>`,at=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-balloon" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 9.984C10.403 9.506 12 7.48 12 5a4 4 0 0 0-8 0c0 2.48 1.597 4.506 4 4.984M13 5c0 2.837-1.789 5.227-4.52 5.901l.244.487a.25.25 0 1 1-.448.224l-.008-.017c.008.11.02.202.037.29.054.27.161.488.419 1.003.288.578.235 1.15.076 1.629-.157.469-.422.867-.588 1.115l-.004.007a.25.25 0 1 1-.416-.278c.168-.252.4-.6.533-1.003.133-.396.163-.824-.049-1.246l-.013-.028c-.24-.48-.38-.758-.448-1.102a3 3 0 0 1-.052-.45l-.04.08a.25.25 0 1 1-.447-.224l.244-.487C4.789 10.227 3 7.837 3 5a5 5 0 0 1 10 0m-6.938-.495a2 2 0 0 1 1.443-1.443C7.773 2.994 8 2.776 8 2.5s-.226-.504-.498-.459a3 3 0 0 0-2.46 2.461c-.046.272.182.498.458.498s.494-.227.562-.495"/>
</svg>`,Ze=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
  <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
</svg>`,Vn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-braces" viewBox="0 0 16 16">
  <path d="M2.114 8.063V7.9c1.005-.102 1.497-.615 1.497-1.6V4.503c0-1.094.39-1.538 1.354-1.538h.273V2h-.376C3.25 2 2.49 2.759 2.49 4.352v1.524c0 1.094-.376 1.456-1.49 1.456v1.299c1.114 0 1.49.362 1.49 1.456v1.524c0 1.593.759 2.352 2.372 2.352h.376v-.964h-.273c-.964 0-1.354-.444-1.354-1.538V9.663c0-.984-.492-1.497-1.497-1.6M13.886 7.9v.163c-1.005.103-1.497.616-1.497 1.6v1.798c0 1.094-.39 1.538-1.354 1.538h-.273v.964h.376c1.613 0 2.372-.759 2.372-2.352v-1.524c0-1.094.376-1.456 1.49-1.456V7.332c-1.114 0-1.49-.362-1.49-1.456V4.352C13.51 2.759 12.75 2 11.138 2h-.376v.964h.273c.964 0 1.354.444 1.354 1.538V6.3c0 .984.492 1.497 1.497 1.6"/>
</svg>`,ot=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
</svg>`,lt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-arrow-up" viewBox="0 0 16 16">
  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4.5a.5.5 0 0 1-1 0V5.383l-7 4.2-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h5.5a.5.5 0 0 1 0 1H2a2 2 0 0 1-2-1.99zm1 7.105 4.708-2.897L1 5.383zM1 4v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1"/>
  <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.354-5.354 1.25 1.25a.5.5 0 0 1-.708.708L13 12.207V14a.5.5 0 0 1-1 0v-1.717l-.28.305a.5.5 0 0 1-.737-.676l1.149-1.25a.5.5 0 0 1 .722-.016"/>
</svg>`,ct=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
  <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
  <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
</svg>`,dt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
</svg>`,We=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
  <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
</svg>`,ut=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-highlights" viewBox="0 0 16 16">
  <path d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0m-8 5v1H4.5a.5.5 0 0 0-.093.009A7 7 0 0 1 3.1 13zm0-1H2.255a7 7 0 0 1-.581-1H8zm-6.71-2a7 7 0 0 1-.22-1H8v1zM1 8q0-.51.07-1H8v1zm.29-2q.155-.519.384-1H8v1zm.965-2q.377-.54.846-1H8v1zm2.137-2A6.97 6.97 0 0 1 8 1v1z"/>
</svg>`,ds=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door" viewBox="0 0 16 16">
  <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"/>
</svg>`,Ns=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
</svg>`,qe=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16">
  <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1 1 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4 4 0 0 1-.128-1.287z"/>
  <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243z"/>
</svg>`,$n=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
</svg>`,zn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-repeat" viewBox="0 0 16 16">
  <path d="M11 5.466V4H5a4 4 0 0 0-3.584 5.777.5.5 0 1 1-.896.446A5 5 0 0 1 5 3h6V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192m3.81.086a.5.5 0 0 1 .67.225A5 5 0 0 1 11 13H5v1.466a.25.25 0 0 1-.41.192l-2.36-1.966a.25.25 0 0 1 0-.384l2.36-1.966a.25.25 0 0 1 .41.192V12h6a4 4 0 0 0 3.585-5.777.5.5 0 0 1 .225-.67Z"/>
</svg>`,ht=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
</svg>`,mt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shield-check" viewBox="0 0 16 16">
  <path d="M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"/>
  <path d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
</svg>`,gt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shield-lock" viewBox="0 0 16 16">
  <path d="M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"/>
  <path d="M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415"/>
</svg>`,pt=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
  <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
</svg>`,Kn=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
</svg>`,ls={"arrow-clockwise":it,"envelope-arrow-up":lt,"exclamation-triangle":ct,"eye-fill":Ae,"gear-fill":We,"house-door":ds,"info-circle":Ns,"link-45deg":qe,"three-dots":pt,balloon:at,bank:Ze,download:ot,eye:dt,highlights:ut,magic:Ye,search:ht,translate:Be};Object.assign(ls,{"plus-circle":$n,"x-circle":Kn,braces:Vn,magic:Ye,repeat:zn});Object.assign(ls,{"shield-check":mt,"shield-lock":gt,person:xs});function Wn(){const{t}=te(),n=G.getState().appTitleHead;function s(){const r=t("icons",{ns:"common",returnObjects:!0}),i=Object.getOwnPropertyNames(r).filter(a=>Object.getOwnPropertyNames(ls).includes(a)).toSorted((a,d)=>{const l=r[a],u=r[d];return!l.context||l.context.length===0?-1:!u.context||u.context.length===0||l.context.includes("statistics")?1:u.context.includes("statistics")?-1:l.context.includes("querybuilder")?1:u.context.includes("querybuilder")?-1:l.context[0].localeCompare(u.context[0])});return e.jsx(X,{xs:1,md:2,xl:3,children:i.map(a=>{const d=t(`icons.${a}.context`,{ns:"common",returnObjects:!0,defaultValue:[]});return e.jsx(H,{children:e.jsx(E,{className:"border-0",children:e.jsxs(E.Body,{children:[e.jsxs(E.Title,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ls[a]},"aria-hidden":"true",className:"rounded border px-2 pb-1"})," ",t(`icons.${a}.label`,{ns:"common"})]}),e.jsx(E.Text,{className:"mb-0",children:t(`icons.${a}.description`,{ns:"common"})}),d.length>0&&e.jsx(E.Text,{className:"mt-1",children:d.map(l=>e.jsx(fe,{children:l},l))})]})})},a)})})}return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{children:e.jsxs("title",{children:[n," â€“ Help"]})}),e.jsxs(ie,{className:"my-4",children:[e.jsx("h1",{className:"h1",children:t("help.title")}),e.jsx("h2",{className:"h2",id:"performing-a-fcs-search-in-resources",children:t("help.performSearch.title")}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.performSearch.textBasicSearch"})}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.performSearch.textAdvancedSearch",components:{iconMagicWand:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})}})}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.performSearch.textLexicalSearch",components:{iconMagicWand:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})}})}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.performSearch.textSearchProgress"})}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.performSearch.textViewResource",components:{iconEye:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae},"aria-hidden":"true"})}})}),e.jsx("h2",{className:"h2",id:"adjusting-search-criteria",children:t("help.adjustSearchCriteria.title")}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.adjustSearchCriteria.text"})}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.adjustSearchCriteria.textOtherSearchTypes"})}),e.jsx("h2",{className:"h2",id:"more-help",children:t("help.moreHelp.title")}),e.jsx("p",{children:e.jsx(W,{i18nKey:"help.moreHelp.text",components:[e.jsx("a",{href:"https://www.clarin.eu/content/content-search-tutorial",children:"Content Search: Tutorial at CLARIN.eu"}),e.jsx("a",{title:t("help.contactTitle"),href:t("urls.contact",{ns:"common"}),children:"CLARIN FCS Helpdesk"})]})}),e.jsx("h2",{className:"h2",id:"more-help",children:t("help.icons.title")}),s()]})]})}const Cs=h.createContext({resources:[],languages:{},weblichtLanguages:[]});Cs.displayName="AggregatorDataContext";function Qn({resources:t,languages:n,weblichtLanguages:s,children:r}){const i={resources:t,languages:n,weblichtLanguages:s};return e.jsx(Cs.Provider,{value:i,children:r})}function Is(){return h.useContext(Cs)}const Ts=h.createContext(void 0);Ts.displayName="AxiosContext";function Ne(){const t=h.useContext(Ts);if(!t)throw new Error('No "axios" instance set, use AxiosProvider to set one');return t}function Gn({axios:t,children:n}){return e.jsx(Ts.Provider,{value:t,children:n})}const _s=h.createContext(void 0);_s.displayName="SearchParamsContext";function As(){const t=h.useContext(_s);if(!t)throw new Error('No "params" data set, use SearchParamsProvider to set one');return t}function Yn({language:t,languageFilter:n,queryType:s,query:r,resourceIDs:i,numberOfResults:a,children:d}){const l={language:t,languageFilter:n,queryType:s,query:r,resourceIDs:i,numberOfResults:a};return e.jsx(_s.Provider,{value:l,children:d})}const bs="byMeta",Xn="all",xt="resource",Jn="title-up",we="mul";function us(t,n=void 0,s={}){return t===we?s?.defaultAnyLanguage??"Any Language":n?.[t]||(s?.defaultUnknownLanguage??"Unknown Language")}function cs(t){const n=ne.getState().locale,s=(a,d=null)=>({...a,subResources:a.subResources.map(l=>s(l,d??a)),rootResourceId:d?.id??null}),r=t.map(a=>s(a,null)),i=function(a,d){const l=B(a.institution,n)??"",u=B(d.institution,n)??"",m=l.localeCompare(u);if(m!==0)return m;const g=B(a.title,n)??"",R=B(d.title,n)??"";return g.toLowerCase().localeCompare(R.toLowerCase())};return Ee(r,a=>{a.subResources.sort(i)}),r.sort(i),r}function Zn(t,n){const s=[],r=[],i=[];return Object.entries(n).forEach(([a,d])=>{d.forEach(l=>{let u=!1;Ee(t,m=>{m.handle===l&&(u=!0,i.push(m))}),u||(console.warn("Handle not found in resources",l),r.push(l))})}),Ee(i,a=>{s.push(a.id)}),{selected:s,unavailable:r}}function Ee(t,n){const s=(r,i)=>{n(r,i)===!1||r.subResources.forEach(s)};t.forEach(s)}function Ge(t,n){let s;const r=i=>s!==void 0?!0:n(i)?(s=i,!0):i.subResources.find(r)!==void 0;return t.find(r),s}function Se(t){const n=[];return Ee(t,s=>{n.push(s.id)}),n}function er(t,n){const s=new Map;return Ee(t,r=>{const i=n(r);s.has(i)||s.set(i,[]),s.get(i).push(r.id)}),s}function sr(t,n,s){const r=[],i=a=>jt(a,i)||lr(a,n,s);return Ee(t,a=>{i(a)&&r.push(a.id)}),r}function tr(t,n){const s=ne.getState().locale,r=new Set;return Ee(t,i=>{if(n.includes(i.id)){const a=B(i.institution,s)??"";r.add(a)}return!0}),Array.from(r)}function ys(t){const n=s=>[s,...s.subResources.map(n).flat()];return t.map(n).flat()}const ft=["en","eng","de","deu"];function nr(t){if(t===null)return null;if(typeof t=="string")return t;for(const s of ft)if(Object.hasOwn(t,s))return t[s];const n=Object.getOwnPropertyNames(t);return n.length>0?t[n[0]]:null}function rr(t,n){return t===null?null:typeof t=="string"?t:n&&Object.hasOwn(t,n)?t[n]:null}function B(t,n){n===void 0&&(n=ne.getState().locale);const s=rr(t,n);return s!==null?s:nr(t)}function ir(t,n){if(t===null||typeof t=="string")return;if(n===void 0&&(n=ne.getState().locale),n&&Object.hasOwn(t,n))return n;for(const r of ft)if(Object.hasOwn(t,r))return r;const s=Object.getOwnPropertyNames(t);if(s.length>0)return s[0]}function es(t,n="en"){const s=typeof t.title=="string"||t.title===null?[n]:Object.getOwnPropertyNames(t.title),r=typeof t.description=="string"||t.description===null?[n]:Object.getOwnPropertyNames(t.description),i=typeof t.institution=="string"||t.institution===null?[n]:Object.getOwnPropertyNames(t.institution),a=[...s,...r,...i];return Array.from(new Set(a))}function ar(t,n){return!(n==="fcs"&&!t.endpoint.searchCapabilities.includes("ADVANCED_SEARCH")||n==="lex"&&!t.endpoint.searchCapabilities.includes("LEX_SEARCH"))}function or(t,n){return!!(n===we||t.languages&&t.languages.length===1&&t.languages[0]===n||t.languages&&t.languages.indexOf(n)>=0)}function jt(t,n){if(!t.subResources||t.subResources.length===0)return!1;let s=!1;const r=i=>{if(n?.(i)===!0){s=!0;return}i.subResources.forEach(r)};return t.subResources.forEach(r),s}function lr(t,n,s){return!(!ar(t,n)||!or(t,s))}const bt={"title-up":(t,n)=>{const s=ne.getState().locale,r=B(t.title,s)??"",i=B(n.title,s)??"";return r.localeCompare(i)},"title-down":(t,n)=>{const s=ne.getState().locale,r=B(t.title,s)??"",i=B(n.title,s)??"";return-r.localeCompare(i)},"institution-up":(t,n)=>{const s=ne.getState().locale,r=B(t.institution,s)??"",i=B(n.institution,s)??"",a=B(t.title,s)??"",d=B(n.title,s)??"",l=r.localeCompare(i);return l!==0?l:a.localeCompare(d)},"institution-down":(t,n)=>{const s=ne.getState().locale,r=B(t.institution,s)??"",i=B(n.institution,s)??"",a=B(t.title,s)??"",d=B(n.title,s)??"",l=-r.localeCompare(i);return l!==0?l:a.localeCompare(d)}};function yt(t,n){const[s,r]=h.useState(t);return h.useEffect(()=>{const i=setTimeout(()=>{r(t)},n);return()=>{clearTimeout(i)}},[t,n]),s}function ws(t,n,s=0,r=n){if(n===t&&n===r&&n.nodeType===Node.ELEMENT_NODE&&s===1)return n.nodeType,n.textContent?.length,n.textContent?.length||0;if(n===t||t===null)return s;const i=n.parentNode;if(i===null)return s;let a=0;const d=i.childNodes;for(let l=0;l<d.length;l++){const u=d[l];if(u===n)break;u.nodeType===Node.TEXT_NODE||u.nodeType===Node.ELEMENT_NODE?a+=u.textContent?.length||0:console.warn("unknown node type",{container:t,node:n,offset:s,parent:i,i:l,child:u})}return ws(t,i,a+s,r)}function wt(t,n){const s=t.textContent?.length||0;if(s<n)return null;let r=0;const i=t.childNodes;for(let a=0;a<i.length;a++){const d=i[a];let l=0;if(d.nodeType===Node.TEXT_NODE||d.nodeType===Node.ELEMENT_NODE?l=d.textContent?.length||0:console.warn("unknown node type, skip",{container:t,offset:n,child:d}),!(l===0&&i.length!==1)&&(r+=l,r>=n)){const u=n-(r-l);return d.nodeType===Node.ELEMENT_NODE?wt(d,u):{node:d,offset:u}}}return i.length,null}function vs(t,n){if(!n)return null;const s=ws(t,n.startContainer,n.startOffset);if(n.startContainer.nodeType===Node.TEXT_NODE&&n.endContainer===n.startContainer)return[s,s+(n.endOffset-n.startOffset)];const r=ws(t,n.endContainer,n.endOffset);return[s,r]}function cr(t,n){if(!(document.activeElement===t))return null;const r=window.getSelection();if(!r)return null;const i=document.createRange(),a=wt(t,n);if(a)try{i.setStart(a.node,a.offset),i.collapse(!0),r.removeAllRanges(),r.addRange(i)}catch(d){console.error("Error trying to set cursor!",d,{container:t,offset:n,startRange:a})}}function Ds(t){if(!(document.activeElement===t))return null;const s=window.getSelection();if(!s||s.rangeCount===0)return null;const r=s.getRangeAt(0),i=vs(t,r);return i?i[0]:null}function dr(t){return t==="cql"?"fcs-cql":t==="fcs"?"fcs-fcsql":t==="lex"?"fcs-lexcql":"plain"}function Ss(t,n){const s=dr(n),r="match-braces rainbow-braces";let i=t;try{i=sn.highlight(t,s)}catch(d){console.warn("Error trying to highlight value",{value:t,error:d,language:s})}return`<pre><code class="language-${s} ${r}">${i}</code></pre>`}function Ke(t){return t?(t=t.replace(/[\n\t]/g," "),t=t.replace(/&nbsp;|\u202F|\u00A0/g," "),t):""}const vt=Ht.forwardRef(({value:t,onChange:n,onCursorChange:s,disabled:r,placeholder:i,queryType:a,delay:d=200,...l},u)=>{const m=h.useRef(null),g=h.useRef(null);h.useImperativeHandle(u,()=>g.current);const[R,x]=h.useState(Ke(t)),[C,y]=h.useState(null),N=yt(R,d),[f,b]=h.useState(N);h.useEffect(()=>{const L=Ss(N,a);if(b(L),g.current){const k=Ds(g.current);y(k)}},[N,a]),h.useEffect(()=>{const L=Ke(t);if(N!==L&&(x(L),b(Ss(L)),g.current)){const k=Ds(g.current);y(k)}},[t,N]),h.useLayoutEffect(()=>{g.current&&C!==null&&cr(g.current,C)});function _(L){const k=L.target.innerText;m.current&&(m.current.value=k),x(k),n?.(k)}function j(L){L.stopPropagation(),L.preventDefault();const K=(L.clipboardData||window.clipboardData).getData("text");I(K)}function F(L){L.key==="Enter"?(L.stopPropagation(),L.preventDefault(),m.current&&m.current.form?.requestSubmit()):L.key==="Backspace"?(L.stopPropagation(),L.preventDefault(),S()):L.key==="Delete"?(L.stopPropagation(),L.preventDefault(),z()):L.ctrlKey&&L.key==="a"||y(null)}function V(L=!1){if(!g.current||!s)return;const k=g.current;if(!(document.activeElement===k))return;const M=window.getSelection();if(!M||M.rangeCount===0)return;const A=[];for(let P=0;P<M.rangeCount;P++){const o=M.getRangeAt(P),w=vs(k,o);w&&A.push(w)}if(A.length===0)return;const[p,U]=A.pop();L?p===U&&(y(p),s?.(p)):s?.(p,p!==U?U:void 0)}function D(L){if(!g.current)return null;const k=g.current;if(!(document.activeElement===k))return null;const M=window.getSelection();if(!M||M.rangeCount===0)return null;const A=[];for(let o=0;o<M.rangeCount;o++){const w=M.getRangeAt(o),J=vs(k,w);J&&A.push(J)}if(A.length===0)return null;A.sort();const p=A.map(([o,w])=>w-o).reduce((o,w)=>o+w,0),U=k.innerText,P=A.toReversed().reduce((o,[w,J])=>o.slice(0,w)+o.slice(J),U);if(L==="backspace"){if(p===0){const o=A.filter(([w,J])=>w===J).map(([,w])=>w).pop();if(o===0)return null;if(o!==void 0)return{value:P.slice(0,o-1)+P.slice(o),offset:o-1}}else{const o=A.map(([,w])=>w).pop();if(o!==void 0)return{value:P,offset:o-p}}return console.warn('invalid "backspace" process, abort',{container:k,selectionIndices:A,oldValue:U,newValueSpansRemoved:P,numDeleted:p}),null}else if(L==="delete"){if(p===0){const o=A.filter(([w,J])=>w===J).map(([,w])=>w).pop();if(o!==void 0)return{value:P.slice(0,o)+P.slice(o+1),offset:o}}else{const o=A.map(([,w])=>w).pop();if(o!==void 0)return{value:P,offset:o-p}}return console.warn('invalid "delete" process, abort',{container:k,selectionIndices:A,oldValue:U,newValueSpansRemoved:P,numDeleted:p}),null}else if(L==="paste"){if(p===0){const o=A.filter(([w,J])=>w===J).map(([w])=>w).shift();if(o!==void 0)return{value:P,offset:o}}else{const o=A.map(([w])=>w).shift();if(o!==void 0)return{value:P,offset:o}}return console.warn('invalid "paste" process, abort',{container:k,selectionIndices:A,oldValue:U,newValueSpansRemoved:P,numDeleted:p}),null}}function I(L){const k=D("paste");if(!k)return;const K=Ke(L),{value:M,offset:A}=k,p=M.slice(0,A)+K+M.slice(A),U=A+L.length;x(p),y(U),m.current&&(m.current.value=p),n?.(p),s?.(U)}function S(){const L=D("backspace");if(!L)return;const{value:k,offset:K}=L,M=Ke(k);x(M),y(K),m.current&&(m.current.value=M),n?.(M),s?.(K)}function z(){const L=D("delete");if(!L)return;const{value:k,offset:K}=L,M=Ke(k);x(M),y(K),m.current&&(m.current.value=M),n?.(M),s?.(K)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{role:"input",disabled:r,placeholder:i,spellCheck:!1,autoCapitalize:"off",autoCorrect:"off",...l,onInput:_,onPaste:j,onKeyDown:F,onKeyUp:()=>V(),onClick:()=>V(!0),tabIndex:r?-1:l.tabIndex,contentEditable:!0,dangerouslySetInnerHTML:{__html:f},ref:g}),i&&t===""&&e.jsx("span",{className:"input-placeholder-simulacrum",children:i}),e.jsx("input",{type:"hidden",ref:m})]})});vt.displayName="ContentEditable";var ue=Ut();function St({show:t,languages:n,resources:s,searchLanguage:r,searchLanguageFilter:i,showResourceCounts:a,showLanguageFilterOptions:d=!0,onModalClose:l}){const{t:u}=te(),[m,g]=h.useState(r||we),[R,x]=h.useState(i||bs),[C,y]=h.useState(""),[N,f]=h.useState(a??!1),b=h.useMemo(()=>{const S=new Map;return s&&(s.forEach(z=>z.languages.forEach(L=>S.set(L,(S.get(L)??0)+1))),S.set(we,s.length)),S},[s]),_=ue.useFuzzySearchList({list:Object.entries(n??{}).toSorted(),queryText:C,getText:S=>[S[0],S[1]],mapResultItem:({item:S,score:z,matches:L})=>({item:S,matches:L,score:z})});if(!n)return null;const j=Math.floor((_.length+2)/3);function F(S){l({language:m,filter:R,action:S})}function V(){g(r||we),x(i||bs)}function D(){f(S=>!S)}function I(S,z,L,k){const K=m===S;let M="d-block py-0 my-1 border-0";return K&&(M+=" fw-semibold selected"),L===void 0&&(L=[null,null]),e.jsxs(Z,{size:"sm",className:M,style:{color:`var(${K?"--bs-green":"--bs-body-colors"})`,backgroundColor:"var(--bs-body-bg)"},onClick:()=>g(S),"data-filter-score":k,children:[K&&e.jsx("span",{className:"selected-marker me-1",children:"âœ“"}),e.jsx(ue.Highlight,{ranges:L[1],text:z})," ",e.jsx("sup",{children:e.jsx(ue.Highlight,{ranges:L[0],text:S})}),N&&b.has(S)&&e.jsxs(e.Fragment,{children:[" (",b.get(S),")"]})]},S)}return e.jsxs(se,{show:t,onHide:()=>F("close"),size:"xl",fullscreen:"lg-down",centered:!0,children:[e.jsx(se.Header,{closeButton:!0,children:e.jsx(se.Title,{children:u("search.languagesModal.title")})}),e.jsxs(se.Body,{className:"px-0",children:[e.jsxs(ie,{className:["px-4"].concat(d?["pb-3 border-bottom"]:[]).join(" "),children:[e.jsxs(X,{children:[e.jsx(H,{sm:!0}),e.jsx(H,{sm:!0,className:"mb-3 mb-sm-2 align-content-end",children:I(we,u("languageCodeToName.any",{ns:"common"}))}),e.jsxs(H,{sm:!0,children:[e.jsx($.Control,{size:"sm",placeholder:u("search.languagesModal.filterInputPlaceholder"),name:"languages-filter",value:C,onChange:S=>y(S.target.value)}),s&&e.jsx($.Check,{name:"languages-show-count",id:"languages-show-count",checked:N,onChange:D,type:"checkbox",label:u("search.languagesModal.checkboxShowNumberOfResources"),className:"mt-1"})]})]}),e.jsxs(X,{children:[e.jsx(H,{sm:!0,children:_.slice(0,j).map(({item:[S,z],matches:L,score:k})=>I(S,z,L,k))}),e.jsx(H,{sm:!0,children:_.slice(j,2*j).map(({item:[S,z],matches:L,score:k})=>I(S,z,L,k))}),e.jsx(H,{sm:!0,children:_.slice(2*j).map(({item:[S,z],matches:L,score:k})=>I(S,z,L,k))})]})]}),d&&e.jsx($,{children:e.jsx(ie,{className:"px-4 pt-3",children:["byMeta","byGuess","byMetaAndGuess"].map(S=>e.jsx($.Check,{type:"radio",name:"filterOpts",value:S,id:`filterOpts-${S}`,checked:R===S,onChange:()=>x(S),label:u(`search.languagesModal.optionLanguage${S}`)},S))})})]}),e.jsxs(se.Footer,{children:[e.jsx(Z,{variant:"secondary",onClick:V,children:u("search.languagesModal.buttonReset")}),e.jsx(Z,{variant:"secondary",onClick:()=>F("abort"),children:u("search.languagesModal.buttonAbort")}),e.jsx(Z,{variant:"primary",onClick:()=>F("confirm"),children:u("search.languagesModal.buttonConfirm")})]})]})}const Es=[{id:"cql",name:"Text layer Contextual Query Language (CQL)",searchLabel:"Full-text search",color:"#29a900",searchPlaceholder:"Elephant"},{id:"fcs",name:"Multi-layer Federated Content Search Query Language (FCS-QL)",searchLabel:"Multi-layer annotation search",color:"#00a8cc",searchPlaceholder:"[word = 'annotation'][word = 'focused']"},{id:"lex",name:"Lexical Resources Contextual Query Language (LexCQL)",searchLabel:"Lexical resource search",color:"#e77e00",searchPlaceholder:"banana"}],os=Object.fromEntries(["cql","fcs","lex"].map(t=>[t,Es.find(n=>n.id===t)])),Fs=["fcs","lex"],ur=[{id:"text",label:"Plain Text"},{id:"csv",label:"CSV"},{id:"tcf",label:"TCF"},{id:"ods",label:"ODS"},{id:"excel",label:"Excel"}],hr="cql",as=[10,20,50,100,200,250],Le="info:srw/diagnostic/1/61",mr=[{id:"cql-single-term",queryType:"cql",query:"Elephant",description:"Query with single term"},{id:"cql-with-boolean",queryType:"cql",query:"cat AND dog",description:"Query with boolean"},{id:"cql-with-phrase",queryType:"cql",query:'"exciting news"',description:"Query with phrase (quoting because of whitespaces)"},{id:"fcs-three-tokens-artznei",queryType:"fcs",query:'[ word = "her.*" ] [ lemma = "Artznei" ] [ pos = "VERB" ]',description:'Phrase with three tokens: a word starting with "her", a lemmatized word, and a verb'},{id:"lex-plain-string",queryType:"lex",query:"apple",description:"Search for plain string"},{id:"lex-lemma-with-language",queryType:"lex",query:'lemma =/lang=deu "Apfel"',description:'Search for German lemma "Apfel"'}];function gr({show:t,queryTypes:n,onModalClose:s}){const{t:r}=te(),i=n&&n.length>0?n:["cql","fcs","lex"],a=mr.filter(m=>i.includes(m.queryType));if(a.length===0)return d("abort"),null;function d(m){s({query:void 0,queryType:void 0,action:m})}function l(m,g){s({query:m,queryType:g,action:"confirm"})}function u(m,g,R,x){return e.jsxs(X,{children:[e.jsx(H,{md:"auto",className:"d-none d-md-block",children:x&&`${x}.`}),e.jsxs(H,{className:"d-flex flex-column",children:[R!==void 0&&e.jsx("div",{children:R}),e.jsx("div",{dangerouslySetInnerHTML:{__html:Ss(m,g)}})]}),e.jsx(H,{md:"auto",className:"d-flex justify-content-end align-items-baseline",children:e.jsx(Z,{size:"sm",onClick:()=>l(m,g),children:r("search.suggestionsModal.buttonUseQuery")})})]},m)}return e.jsxs(se,{id:"search-query-suggestions-modal",show:t,onHide:()=>d("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(se.Header,{closeButton:!0,children:e.jsx(se.Title,{children:r("search.suggestionsModal.title")})}),e.jsx(se.Body,{className:"px-0",children:e.jsx(ie,{fluid:!0,children:i.map(m=>{const g=a.filter(R=>R.queryType===m);return g.length===0?null:e.jsxs(h.Fragment,{children:[e.jsx(X,{children:e.jsx(H,{children:e.jsx("h4",{className:"border-bottom pb-2",children:r(`queryTypes.${m}.nameLong`,{ns:"common",defaultValue:os[m]?.name??m.toUpperCase()})})})}),g.map((R,x)=>u(R.query,R.queryType,R.description,x+1))]},m)})})}),e.jsx(se.Footer,{children:e.jsx(Z,{variant:"primary",onClick:()=>d("close"),children:r("search.suggestionsModal.buttonClose")})})]})}function Rt({disabled:t,value:n,onChange:s,delay:r=300}){const[i,a]=h.useState(n??""),d=yt(i,r);return h.useEffect(()=>{s(d)},[s,d]),e.jsx($.Control,{type:"search",placeholder:"Search for ...",value:i,onChange:l=>a(l.target.value),disabled:t})}function Lt(t,n,s,r){const i=ys(n);r??=["title","institution","description"];const a=ue.useFuzzySearchList({list:i,queryText:t,getText:x=>{const C=[];return r.includes("title")&&C.push(B(x.title,s)),r.includes("institution")&&C.push(B(x.institution,s)),r.includes("description")&&C.push(B(x.description,s)),C},mapResultItem:({item:x,score:C,matches:y})=>{const N=new Map;let f=0;return r.includes("title")&&N.set("title",y[f++]),r.includes("institution")&&N.set("institution",y[f++]),r.includes("description")&&N.set("description",y[f++]),{resource:x,matches:N,score:C}}}),d=a.reduce((x,{resource:C,matches:y})=>(x.set(C.id,y),x),new Map),l=a.reduce((x,{resource:C,score:y})=>x.set(C.id,y),new Map),u=new Set;a.filter(({resource:x})=>x.rootResourceId!==null).forEach(({resource:x,score:C})=>{const y=l.get(x.rootResourceId);y===void 0?(u.add(x.rootResourceId),l.set(x.rootResourceId,C)):C<y&&l.set(x.rootResourceId,C)});const m=n.filter(x=>u.has(x.id)).map(x=>({resource:x,score:l.get(x.id)}));return{resources:[...a.filter(({resource:x})=>!x.rootResourceId),...m].toSorted(({score:x},{score:C})=>x===C?0:x===void 0?1:C===void 0?-1:x-C).map(({resource:x})=>x),matches:d,scores:l}}function Ms({resource:t,selectedResourceIDs:n,highlighting:s,highlightings:r,shouldBeShown:i,localeForInfos:a,onSelectClick:d,languageCodeToName:l}){const{t:u}=te(),m=G.getState().isAuthenticated,[g,R]=h.useState(!1),[x,C]=h.useState(!1);s??=r?.get(t.id)??new Map;const y=n.includes(t.id),N=es(t),f=ge(S=>S.locale),[b,_]=h.useState(f);if(h.useEffect(()=>{f&&_(f)},[f]),h.useEffect(()=>{a&&_(a)},[a]),typeof i=="function"&&!i(t))return null;if(i===!1)return null;const j=typeof i=="function"?t.subResources.some(S=>i(S)):!0;function F(){g&&document.getSelection()?.type==="Range"||R(S=>!S)}function V(){d(t,!y)}function D(){C(S=>!S)}function I(){if(t.availabilityRestriction!=="NONE")return e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:m?mt:gt}})," "]})}return e.jsxs(e.Fragment,{children:[e.jsxs(X,{className:`p-2 m-1 ${g&&"border-bottom"}`,children:[e.jsx(H,{md:"auto",sm:1,onClick:V,children:e.jsx($.Check,{id:`resource-selection-${t.id}`,"aria-label":u("search.results.resourceInfo.checkboxResourceAriaLabel",{title:t.title}),children:e.jsx($.Check.Input,{checked:y,onChange:()=>{}})})}),e.jsxs(H,{md:8,sm:11,className:`mb-sm-2 ${g?"":"text-truncate"}`,onClick:F,children:[e.jsxs("h4",{className:`h5 ${g?"":"text-truncate"}`,children:[I(),e.jsx(ue.Highlight,{text:B(t.title,b)??"",ranges:s.get("title")??null})," ",t.landingPage&&e.jsx("small",{children:e.jsxs("a",{href:t.landingPage,className:"matomo_link",target:"_blank",children:[u("search.resourcesModal.resource.moreInformation")," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:ds}})]})})]}),e.jsx("p",{className:`mb-0 ${g?"":"text-truncate"}`,children:B(t.description,b)&&e.jsx(ue.Highlight,{text:B(t.description,b)??"",ranges:s.get("description")??null})})]}),e.jsxs(H,{md:{span:3,offset:0},sm:{span:11,offset:1},className:`${g?"":" text-truncate"}`,onClick:F,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ze}})," ",e.jsx(ue.Highlight,{text:B(t.institution,b)??"",ranges:s.get("institution")??null}),e.jsx("br",{}),e.jsx("i",{dangerouslySetInnerHTML:{__html:Be}})," ",t.languages.map(l).sort().join(", "),g&&N.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx(Je,{type:"radio",name:`resources-${t.id}-info-languages`,defaultValue:b,onChange:S=>_(S),onClick:S=>S.stopPropagation(),className:"mt-2",children:N.toSorted().map(S=>e.jsx(De,{variant:"outline-secondary",size:"sm",id:`resources-${t.id}-info-languages-${S}`,value:S,type:"radio",children:S},S))})]})]}),j&&t.subResources.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-100"}),e.jsx(H,{md:"auto",sm:1,style:{width:"2.8rem"}}),e.jsx(H,{md:{span:8,offset:0},sm:{span:11,offset:1},children:e.jsx(Z,{variant:"link",size:"sm",className:"ps-0",onClick:D,children:u("search.resourcesModal.resource.toggleExpand",{context:x?"collapse":"expand",count:t.subResources.length})})})]})]}),j&&x&&e.jsx(E,{className:"ms-md-5 ms-sm-2 border-end-0 border-top-0 rounded-end-0 rounded-top-0",children:t.subResources.map(S=>e.jsx(Ms,{resource:S,highlightings:r,selectedResourceIDs:n,shouldBeShown:i,onSelectClick:d,languageCodeToName:l},S.id))})]})}function Bs({title:t,resources:n,selectedResourceIDs:s,resourceScores:r,highlightings:i,expanded:a,shouldBeShown:d,localeForInfos:l,onSelectClick:u,onExpandToggleClick:m,onSelectAllClick:g,onDeselectAllClick:R,languageCodeToName:x}){const{t:C}=te(),[y,N]=h.useState(a);h.useEffect(()=>{N(a)},[a]);const f=r!==void 0?n.filter(j=>r.has(j.id)).toSorted((j,F)=>{const V=r.get(j.id),D=r.get(F.id);return V===D?0:V===void 0?1:D===void 0?-1:V-D}):n;if(f.length===0)return null;function b(){N(j=>!j),m(!y)}function _(){const j=n.filter(I=>!I.rootResourceId),F=Se(j).length,V=j.length,D=Se(j).filter(I=>s.includes(I)).length;return C("search.resourcesModal.grouped.msgResources",{count:V,nested:F-V,context:F-V?"nested":null})+(D!==F?C("search.resourcesModal.grouped.msgResourcesSelected",{count:D}):"")}return e.jsxs(ie,{className:"border-bottom pb-2 mb-4 px-0",children:[e.jsxs(X,{className:"px-3",children:[e.jsx(H,{md:9,sm:12,children:e.jsx("h3",{children:t})}),e.jsxs(H,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",style:{height:"fit-content"},children:[e.jsx(Z,{size:"sm",variant:"secondary",onClick:b,"aria-expanded":y,children:C("search.resourcesModal.grouped.buttonExpand",{context:y?"hide":"show"})}),e.jsx(Z,{size:"sm",onClick:()=>g(n),children:C("search.resourcesModal.grouped.buttonSelectAll")}),e.jsx(Z,{size:"sm",onClick:()=>R(n),children:C("search.resourcesModal.grouped.buttonDeselectAll")})]})]}),e.jsx(X,{className:"px-3",children:e.jsx(H,{children:_()})}),e.jsx(Js,{in:y,children:e.jsx(ie,{children:f.map(j=>e.jsx(Ms,{resource:j,highlightings:i,selectedResourceIDs:s,shouldBeShown:d,onSelectClick:u,languageCodeToName:x,localeForInfos:l},j.id))})})]})}function pr({show:t,showGrouping:n,resources:s,languages:r,availableResources:i,selectedResources:a,onModalClose:d}){const{t:l}=te(),u=ge(c=>c.locale),[m,g]=h.useState(u);h.useEffect(()=>{u&&g(u)},[u]);const R=new Intl.DisplayNames([u,"en"],{type:"language"}),[x,C]=h.useState(a||i),[y,N]=h.useState(Xn),[f,b]=h.useState(xt),[_,j]=h.useState(Jn),[F,V]=h.useState(""),[D,I]=h.useState({}),[S,z]=h.useState({});h.useEffect(()=>{n&&b(n)},[t,n]),h.useEffect(()=>C(a),[a]);const L=s.filter(c=>i.includes(c.id)).toSorted(bt[_]),K=L.map(c=>es(c)).flat().reduce((c,v)=>c.set(v,(c.get(v)??0)+1),new Map),{resources:M,matches:A,scores:p}=Lt(F,L,m),U=h.useMemo(()=>{const c=new Map;return f==="institution"?Object.entries(D).forEach(([v,T])=>{c.set(v,T.resources.reduce((q,ye)=>{const he=p.get(ye.id);return he===void 0?q:q===void 0?he:q<he?q:he},void 0))}):f==="language"&&Object.entries(S).forEach(([v,T])=>{c.set(v,T.resources.reduce((q,ye)=>{const he=p.get(ye.id);return he===void 0?q:q===void 0?he:q<he?q:he},void 0))}),c},[f,p,D,S]);if(h.useMemo(()=>{const c={},v={};s.forEach(T=>{const q=B(T.institution,m)??"";Object.getOwnPropertyNames(c).includes(q)||(c[q]={expanded:!0,resources:[]}),c[q].resources.push(T),T.languages.forEach(ye=>{Object.getOwnPropertyNames(v).includes(ye)||(v[ye]={expanded:!0,resources:[]}),v[ye].resources.push(T)})}),I(c),z(v)},[s,m]),!s)return null;const P={total:Se(s).length,totalRoot:s.length,available:i.length,selected:x.length,visible:Se(M.map(c=>c)).length,visibleRoot:M.length};function o(c){return us(c,r,{defaultAnyLanguage:l("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:l("languageCodeToName.unknown",{ns:"common"})})}function w(c,v){const T=x.filter(q=>!c.includes(q));C(v?[...T,...c]:T)}function J(c){d({resourceIDs:x,action:c})}function Y(c){N(c.target.value)}function ee(c){b(c.target.value)}function pe(c){j(c.target.value)}function je(){C(i)}function Ve(){C([])}function Pe(){C(M.map(c=>c.id))}function be(c,v){w(Se([c]),v)}function Oe(c){w(Se(c),!0)}function He(c){w(Se(c),!1)}function Ce(c){return!(!i.includes(c.id)||y==="selected"&&!x.includes(c.id)&&!jt(c,v=>x.includes(v.id)))}function $e(){return f==="institution"?Object.entries(D).toSorted(([c],[v])=>{const T=U.get(c),q=U.get(v);return T===q?0:T===void 0?1:q===void 0?-1:T-q}).map(([c,{expanded:v,resources:T}])=>e.jsx(Bs,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ze}})," ",c]}),resources:T,selectedResourceIDs:x,resourceScores:p,highlightings:A,expanded:v,shouldBeShown:Ce,onSelectAllClick:Oe,onExpandToggleClick:q=>{I({...D,[c]:{...D[c],expanded:q}})},onDeselectAllClick:He,onSelectClick:be,languageCodeToName:o,localeForInfos:m},c)):f==="language"?Object.entries(S).toSorted(([c],[v])=>{const T=U.get(c),q=U.get(v);return T===q?0:T===void 0?1:q===void 0?-1:T-q}).map(([c,{expanded:v,resources:T}])=>e.jsx(Bs,{title:e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Be}})," ",o(c)," [",c,"]"]}),resources:T,selectedResourceIDs:x,resourceScores:p,highlightings:A,expanded:v,shouldBeShown:Ce,onSelectAllClick:Oe,onExpandToggleClick:q=>S[c].expanded=q,onDeselectAllClick:He,onSelectClick:be,languageCodeToName:o,localeForInfos:m},c)):M.filter(c=>!c.rootResourceId).map(c=>e.jsx(Ms,{resource:c,selectedResourceIDs:x,highlighting:A.get(c.id),highlightings:A,shouldBeShown:Ce,onSelectClick:be,languageCodeToName:o,localeForInfos:m},c.id))}return e.jsxs(se,{id:"resource-selection-modal",show:t,onHide:()=>J("close"),size:"xl",fullscreen:"xl-down",centered:!0,children:[e.jsx(se.Header,{closeButton:!0,children:e.jsx(se.Title,{children:l("search.resourcesModal.title")})}),e.jsxs(se.Body,{className:"px-0",children:[e.jsx($,{className:"px-3 pb-3 border-bottom",onSubmit:c=>c.preventDefault(),children:e.jsxs(ie,{children:[e.jsxs(X,{className:"d-sm-flex row-gap-2 justify-content-around",children:[e.jsx(H,{md:2,sm:6,children:e.jsx(Re,{label:"View",controlId:"resource-view-options-visibility",children:e.jsxs($.Select,{value:y,onChange:Y,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"selected",children:"Selected only"})]})})}),e.jsx(H,{md:2,sm:6,children:e.jsx(Re,{label:"Group by",controlId:"resource-view-options-grouping",children:e.jsxs($.Select,{value:f,onChange:ee,children:[e.jsx("option",{value:"resource",children:"(Resource)"}),e.jsx("option",{value:"institution",children:"Institution"}),e.jsx("option",{value:"language",children:"Language"})]})})}),e.jsx(H,{md:2,sm:6,children:e.jsx(Re,{label:"Sort by",controlId:"resource-view-options-sorting",children:e.jsxs($.Select,{value:_,onChange:pe,disabled:f!=="resource"||F.trim()!=="",children:[e.jsx("option",{value:"title-up",children:"Title (up)"}),e.jsx("option",{value:"title-down",children:"Title (down)"}),e.jsx("option",{value:"institution-up",children:"Institution (up)"}),e.jsx("option",{value:"institution-down",children:"Institution (down)"})]})})}),e.jsx(H,{md:3,sm:12,children:e.jsx(Re,{label:"Resource filter query",controlId:"resource-view-options-filter",children:e.jsx(Rt,{value:F,onChange:c=>V(c)})})}),e.jsxs(H,{md:3,sm:12,className:"gap-1 d-inline-flex column-gap-2 justify-content-evenly",children:[e.jsx(Z,{onClick:je,children:"Select all"}),e.jsx(Z,{onClick:Pe,disabled:y!=="all"||F.trim()==="",children:"Select visible"}),e.jsx(Z,{onClick:Ve,children:"Deselect all"})]})]}),K.size>1&&e.jsxs($.Group,{as:X,controlId:"resource-info-language",className:"mt-2",children:[e.jsx($.Label,{column:!0,sm:"auto",style:{fontSize:"0.875rem"},children:l("search.resourcesModal.labelChangeResourceInfoLanguage")}),e.jsx(H,{sm:"auto",children:e.jsx(Je,{type:"radio",name:"resource-info-languages",defaultValue:m,onChange:c=>g(c),children:Array.from(K.entries()).toSorted().map(([c,v])=>e.jsxs(De,{size:"sm",id:`resource-info-languages-${c}`,value:c,variant:"secondary",title:l("search.resourcesModal.buttonChangeResourceInfoLanguageTitle",{count:v,language:c,languageName:R.of(c)}),children:[R.of(c)," ",e.jsx("sup",{children:c})]},c))})})]})]})}),e.jsx("p",{className:"m-4 mb-0",children:l("search.resourcesModal.msgResourcesSelected",{count:P.selected,total:P.visible,available:P.available,context:P.available!==P.visible?"available":null})}),e.jsx(ie,{className:"px-3 pt-3",children:$e()})]}),e.jsx(se.Footer,{children:e.jsx(Z,{variant:"primary",onClick:()=>J("confirm"),children:l("search.resourcesModal.buttonConfirm")})})]})}function xr(){const[t,n]=h.useState(!1);return[t,()=>{t!==!0&&n(!0)}]}function fr(){const t=Gs(),{hash:n}=Rs(),s=h.useMemo(()=>new URLSearchParams(n.substring(1)),[n]),r=h.useCallback(i=>{const a=Ws(typeof i=="function"?i(new URLSearchParams(s)):i),d=a.entries().next().done?"":`#${a}`;n!==d&&t({hash:d})},[s,n,t]);return[s,r]}const jr=h.lazy(()=>le(()=>import("./fcs-sru-aggregator-ui-querybuilder.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url));function qs(t,n=""){const s=t.get("query");return s||n}function Vs(t,n="cql"){const s=t.get("queryType");if(s){if(Es.find(r=>r.id===s)!==void 0)return s;console.warn("Found unsupported queryType in search params",s)}return n}function br({resources:t,languages:n,onSearch:s,onShowToast:r,availableResources:i=null,selectedResources:a=null,hasSearch:d=!1,disabled:l=!1}){const{t:u}=te(),[m,g]=Ue(),[R,x]=fr(),[C,y]=h.useState(!1),[N,f]=h.useState(xt),[b,_]=h.useState(!1),[j,F]=h.useState(!1),[V,D]=h.useState(!1),[I,S]=xr(),[z,L]=h.useState(we),[k,K]=h.useState(bs),[M,A]=h.useState(Vs(m,hr)),[p,U]=h.useState(i??[]),[P,o]=h.useState(a??[]),[w,J]=h.useState(as[0]),[Y,ee]=h.useState(qs(m,"")),[pe]=h.useState(null),[je,Ve]=h.useState(!1);h.useEffect(()=>{o(a??[])},[a]);const Pe=h.useCallback(O=>{const Q=sr(O,M,k==="byGuess"?we:z);return i&&i.length>0?Q.filter(me=>i.includes(me)):Q},[M,z,k,i]);h.useEffect(()=>{const O=Pe(t);U(O),o(Q=>Q.filter(me=>O.includes(me)))},[t,Pe]);const be=h.useCallback(()=>{const O={language:z,languageFilter:k,queryType:M,query:Y,resourceIDs:P??[],numberOfResults:w};O.query!==""&&O.resourceIDs.length!==0&&s(O)},[z,k,w,s,Y,M,P]);h.useEffect(()=>{if(m&&(ee(Q=>qs(m,Q)),A(Q=>Vs(m,Q)),!m.get("x-aggregation-context"))){const Q=m.get("mode");Q&&(Q==="search"&&be(),m.delete("mode"),g(m))}},[m,g,be]),h.useEffect(()=>{m.get("query")!==Y&&(m.set("query",Y),g(m))},[Y,m,g]),h.useEffect(()=>{m.get("queryType")!==M&&(m.set("queryType",M),g(m))},[M,m,g]),h.useEffect(()=>{R.has("openQueryBuilder")&&(S(),D(!0),R.delete("openQueryBuilder"),x(R))},[R,x,S]);const Oe=tr(t,P??[]).length,He=t.find(O=>O.searchCapabilitiesResolved.includes("ADVANCED_SEARCH"))!==void 0,Ce=t.find(O=>O.searchCapabilitiesResolved.includes("LEX_SEARCH"))!==void 0,$e=Fs.includes(M);function c(O){O&&A(O)}function v(O){let Q=Number.parseInt(O.target.value);Q<10&&(Q=10),Q>250&&(Q=250),as.includes(Q)||console.warn("Invalid number of results?!",{valid:as,value:Q}),J(Q)}function T({language:O,filter:Q,action:me}){_(!1),me!=="abort"&&(L(O),K(Q))}function q({resourceIDs:O,action:Q}){y(!1),Q!=="abort"&&o(O)}function ye({query:O,queryType:Q,action:me}){F(!1),me!=="abort"&&me!=="close"&&(!O||!Q||(A(Q),ee(O)))}function he({query:O,validResources:Q,action:me}){D(!1),me!=="abort"&&me!=="close"&&(ee(O),P.length!==Q.length&&r?.({title:u("search.toasts.searchInput.title"),body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:u("search.toasts.searchInput.msgResourcesChangedDueToQuery")}),e.jsx("p",{children:u("search.toasts.searchInput.msgResourcesAmountChanged",{before:P.length,after:Q.length})}),e.jsx("hr",{}),e.jsx(Z,{onClick:()=>o(P),children:u("search.toasts.searchInput.buttonRevertSelection")})]}),variant:"info",delay:7e3}),o(Q))}function ks(O){ee(O)}function Et(O){O.preventDefault(),be()}function Mt(){const O=(P??[]).length,Q=t.length===O||p.length===O?"all":null;return u("search.searchInput.buttonSelectedResources",{count:O,context:Q})}return e.jsxs("search",{id:"fcs-query",children:[e.jsxs($,{noValidate:!0,onSubmit:Et,children:[e.jsxs(Yt,{size:d?void 0:"lg",hasValidation:!0,children:[e.jsx(Z,{variant:"outline-secondary",type:"button",id:"fcs-search-query-suggestions-button","aria-label":u("search.searchInput.buttonOpenQuerySuggestions"),onClick:()=>F(!0),children:e.jsx("i",{dangerouslySetInnerHTML:{__html:at},"aria-hidden":"true"})}),e.jsx($.Control,{placeholder:"Elephant","aria-label":u("search.searchInput.inputQueryAriaLabel"),"aria-describedby":"fcs-search-input-button",className:"text-center search-query-input",disabled:l,"aria-disabled":l,value:Y,isInvalid:!!pe,...je?{as:vt,queryType:M,onChange:ks}:{onChange:O=>ks(O.target.value)}}),$e&&e.jsx(Z,{id:"fcs-search-input-query-builder-button",variant:"outline-secondary","aria-label":u("search.searchInput.buttonOpenQueryBuilderAriaLabel"),className:"border-end-0 d-none d-md-block",onClick:()=>{S(),D(!0)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ye},"aria-hidden":"true"})}),e.jsx(De,{id:"fcs-search-input-enhanced-button",value:"enhance-query",type:"checkbox",checked:je,onChange:()=>Ve(O=>!O),variant:"outline-secondary","aria-label":u("search.searchInput.buttonEnhanceQueryAriaLabel",{context:je?"enabled":"disabled"}),className:"d-flex align-items-center border-end-0",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:ut},"aria-hidden":"true"})}),e.jsxs(Z,{variant:"outline-primary",type:"submit",id:"fcs-search-input-button",disabled:l||Y.trim().length===0,"aria-disabled":l,"aria-label":u("search.searchInput.buttonSearchAriaLabel"),children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ht},"aria-hidden":"true",className:"d-inline d-md-none"}),e.jsx("span",{className:"d-none d-md-inline",children:u("search.searchInput.buttonSearch")})]}),e.jsx($.Control.Feedback,{type:"invalid",children:pe?.msg})]}),e.jsx("div",{id:"fcs-query-filters",className:"mt-2 mb-3 lh-lg text-center",children:e.jsx(W,{i18nKey:"search.searchInput.filtersSummary",components:[e.jsxs(oe,{className:"d-inline-block",onSelect:c,"aria-disabled":l,"aria-label":u("search.searchInput.dropdownQueryTypeAriaLabel"),children:[e.jsxs(oe.Toggle,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2 no-arrow",disabled:l,"aria-disabled":l,style:os[M]?{"--color":os[M].color}:{},children:[u(`queryTypes.${M}.nameShort`,{ns:"common",defaultValue:os[M]?.searchLabel??M.toUpperCase()})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:We},"aria-hidden":"true"})]}),e.jsx(oe.Menu,{children:Es.filter(O=>O.id==="cql"||O.id==="fcs"&&He||O.id==="lex"&&Ce).map(O=>e.jsx(oe.Item,{as:"button",eventKey:O.id,onClick:Q=>Q.preventDefault(),style:{"--color":O.color,background:"color-mix(in srgb, var(--color) 50%, transparent)"},children:u(`queryTypes.${O.id}.nameLong`,{ns:"common",defaultValue:O.name})},O.id))})]}),e.jsxs(Z,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:l,"aria-disabled":l,onClick:()=>{f("resource"),y(!0)},children:[Mt()," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:We},"aria-hidden":"true"})]}),e.jsxs(Z,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",disabled:l,"aria-disabled":l,onClick:()=>{f("institution"),y(!0)},children:[u("search.searchInput.buttonSelectedInstitutions",{count:Oe})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:We},"aria-hidden":"true"})]}),e.jsxs(Z,{size:"sm",variant:"outline-dark",className:"mx-1 pe-2",onClick:()=>_(!0),disabled:l,"aria-disabled":l,children:[us(z,n??{},{defaultAnyLanguage:u("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:u("languageCodeToName.unknown",{ns:"common"})})," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:We},"aria-hidden":"true"})]}),e.jsx($.Select,{size:"sm",className:"d-inline-block w-auto mx-1",onChange:v,value:w,"aria-label":u("search.searchInput.selectNumberOfSearchResultsAriaLabel"),disabled:l,"aria-disabled":l,children:as.map(O=>e.jsx("option",{value:O,children:O},O))})]})})]}),e.jsx(St,{languages:n,resources:t,searchLanguage:z,show:b,onModalClose:T}),e.jsx(pr,{resources:t,languages:n,availableResources:p,selectedResources:P??[],show:C,showGrouping:N,onModalClose:q}),e.jsx(gr,{queryTypes:[M],show:j,onModalClose:ye}),Fs.includes(M)&&I&&e.jsx(h.Suspense,{fallback:e.jsx(e.Fragment,{children:u("loading",{ns:"querybuilder",defaultValue:u("generic.loadingComponent",{ns:"common"})})}),children:e.jsx(jr,{query:Y,queryType:M,resources:t,selectedResources:P,show:V,onModalClose:he})})]})}function yr({searchId:t,resourceId:n,numberOfResults:s,pollDelay:r=1500}){const{t:i}=te(),a=Ne(),d=Ls(),[l,u]=h.useState(!1),{isPending:m,mutate:g,reset:R}=Ys({mutationFn:cn.bind(null,a,t,{resourceId:n,numberOfResults:s}),mutationKey:["search-result-load-more",t,n],onSuccess:async j=>{j!==void 0&&t!==j&&console.warn("SearchIDs should be the same?!",{searchId:t,searchIdNewButSame:j,resourceId:n}),await d.invalidateQueries({queryKey:["search-results",t,n]}),u(!0)}});r??=1500;const{data:x,isLoading:C,isFetching:y}=ve({queryKey:["search-results",t,n],queryFn:un.bind(null,a,t,n),enabled:l,refetchInterval(j){return j.state.data&&j.state.data.inProgress?r:!1}}),N=m||C||y,f=!!x&&!x.inProgress,b=N||l;l&&f&&(l&&u(!1),d.invalidateQueries({queryKey:["search-result-details",t,n]}));async function _(){R(),g()}return e.jsx(Z,{className:"more-results-button",disabled:b,onClick:_,children:b?e.jsx(Zs,{animation:"border",className:"d-block"}):e.jsxs(e.Fragment,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:pt}})," ",i("search.results.buttonLoadMore")]})})}function wr(t,n=".."){const s=t.map(l=>l.split("/")),r=Math.max(...s.map(l=>l.length)),a=Array.from(Array(r).keys()).map(l=>new Set(s.map(u=>u.length>l?u[l]:!1)).size===1).reduce((l,u,m,g,R=n??"..")=>u?l&&l[l.length-1]!==R?l.concat([R]):l:l.concat([m]),[]);return t.map(l=>[l,l.split("/")]).map(([l,u])=>[l,a.map(m=>typeof m=="number"?u[m]:m).join("/").replace(/\/+$/,"")]).reduce((l,[u,m])=>l.set(u,m),new Map)}function vr(t,n){const s=t.filter(i=>i.spans.every(a=>a.text&&a.text.length===(a.range?.[1]??0)-(a.range?.[0]??0))||i.spans.every(a=>a.text&&a.text.length===(a.range?.[1]??0)-(a.range?.[0]??0)+1));return n?s.filter(i=>{const a=n.get(i.id);return a?!!["text","word"].includes(a.layerType.toLowerCase()):!0}).toSorted((i,a)=>{const d=n.get(i.id),l=n.get(a.id);if(d===void 0||l===void 0){if(d===l)return 0;if(d===void 0)return 1;if(l===void 0)return-1}const u=d.layerType.toLowerCase(),m=l.layerType.toLowerCase();if(u==="word"||m==="word"){if(u===m)return 0;if(u==="word")return-1;if(m==="word")return 1}if(d.qualifier!==null&&d.qualifier!==void 0||l.qualifier!==null&&l.qualifier!==void 0){if(d.qualifier!==null&&d.qualifier!==void 0&&l.qualifier!==null&&l.qualifier!==void 0)return 0;if(d.qualifier!==null&&d.qualifier!==void 0)return 1;if(l.qualifier!==null&&l.qualifier!==void 0)return-1}return 0}):s}function Nt({data:t,resource:n}){const s=h.useRef(null),r=n?.availableLayers?.reduce((a,d)=>a.set(d.resultId,d),new Map);function i(a){const d=a.map(x=>x.id),l=wr(d),u=Math.max(...a.map(x=>x.spans.length)),g=vr(a,r)?.[0]?.id;a.sort((x,C)=>g===void 0?0:x.id===g?-1:C.id===g?1:0);const R=d.length>1;return e.jsxs(re,{hover:!0,responsive:!0,className:"mb-0 results-plain",style:{width:"unset"},children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[r!==void 0&&R&&e.jsx("th",{scope:"col",children:"Layer Type"}),R&&e.jsx("th",{scope:"col",children:"Layer Identifier"}),Array(u).fill(null).map((x,C)=>e.jsx("th",{scope:"col",children:"Token"},C))]})}),e.jsx("tbody",{children:a.map(x=>e.jsxs("tr",{className:["text-nowrap"].concat([x.id===g&&a.length>1?"table-primary":null]).filter(Boolean).join(" "),children:[r!==void 0&&R&&e.jsx("td",{scope:"row",className:"text-uppercase",children:r.get(x.id)?.layerType}),R&&e.jsx("td",{scope:"row",title:x.id,className:"border-end",children:l.get(x.id)}),x.spans.map((C,y)=>e.jsx("td",{children:C.hit?e.jsx("mark",{children:e.jsx("strong",{children:C.text})},y):C.text},C.range?.join("-")??y))]},x.id))})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(re,{responsive:!0,striped:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Annotation Layers"})]})}),e.jsx("tbody",{children:t.records.filter(a=>a.adv!==null).map((a,d)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:d+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[a.ref&&e.jsx("a",{href:a.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:qe}})})," ",a.pid&&e.jsx(Me,{placement:"auto-start",container:s,delay:{show:250,hide:400},overlay:e.jsx(Fe,{id:`ttip-${a.pid}-${d}`,children:a.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:i(a.adv)})]},`${a.pid??a.ref??t.resource.id}-${d}`))})]}),e.jsx("div",{ref:s,className:"tooltip-mounting-point"})]})}function Ct({data:t}){const n=h.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(re,{hover:!0,responsive:!0,className:"mb-0 results-kwic",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Left Context"}),e.jsx("th",{scope:"col",children:"Hit"}),e.jsx("th",{scope:"col",children:"Right Context"})]})}),e.jsx("tbody",{children:t.records.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[s.ref&&e.jsx("a",{href:s.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:qe}})})," ",s.pid&&e.jsx(Me,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Fe,{id:`ttip-${s.pid}-${r}`,children:s.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:s.hits.left}),e.jsx("td",{children:s.hits.keyword&&e.jsx("mark",{children:e.jsx("strong",{children:s.hits.keyword})})}),e.jsx("td",{children:s.hits.right})]},`${s.pid??s.ref??t.resource.id}-${r}`))})]}),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function It({data:t}){const n=h.useRef(null);return e.jsxs("div",{className:"results-lexical-entry d-flex flex-column flex-wrap column-gap-2 row-gap-2",children:[t.records.filter(s=>s.lex!==null).map((s,r)=>e.jsx(E,{className:"flex-grow-1 w-100",children:e.jsxs(E.Body,{children:[e.jsx(E.Title,{children:s.lex.fields.filter(i=>i.type==="lemma").map(i=>i.values).flat(1).map(i=>e.jsx("span",{children:i.value}))}),e.jsxs(Qe,{variant:"flush",children:[(s.lex.lang||s.lex.langUri)&&e.jsxs(Qe.Item,{children:[e.jsx("strong",{children:"lang"}),": ",s.lex.lang," ",s.lex.langUri]}),s.lex.fields.filter(i=>i.type!=="lemma").map(i=>e.jsxs(Qe.Item,{children:[e.jsx("strong",{children:i.type}),":",i.values.map((a,d)=>e.jsx("span",{className:"ms-2 lex-value",children:a.value},d))]},i.type))]}),e.jsx(E.Link,{children:s.ref&&e.jsxs("a",{href:s.ref,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:qe}})," Original results ..."]})}),e.jsx(E.Link,{children:s.pid&&e.jsx(Me,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Fe,{id:`ttip-${s.pid}-${r}`,children:s.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})})]})},`${s.pid??s.ref??t.resource.id}-${r}`)),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function Tt({data:t}){const n=h.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(re,{hover:!0,responsive:!0,className:"mb-0 results-lex-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:t.records.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[s.ref&&e.jsx("a",{href:s.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:qe}})})," ",s.pid&&e.jsx(Me,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Fe,{id:`ttip-${s.pid}-${r}`,children:s.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:s.hits.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):i.hit&&i.hitKind?e.jsx("span",{className:`lex-hitkind-${i.hitKind}`,title:`Annotated as "${i.hitKind.split("-").slice(1).join("-")}"`,children:i.text},a):e.jsx("span",{children:i.text},a))})]},`${s.pid??s.ref??t.resource.id}-${r}`))})]}),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function _t({data:t}){const n=h.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsxs(re,{hover:!0,responsive:!0,className:"mb-0 results-plain",children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:"References"}),e.jsx("th",{scope:"col",children:"Result with Hit"})]})}),e.jsx("tbody",{children:t.records.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{scope:"row",className:"result-idx text-end text-muted d-none d-sm-table-cell",children:r+1}),e.jsxs("td",{scope:"row",className:"result-refs",children:[s.ref&&e.jsx("a",{href:s.ref,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:qe}})})," ",s.pid&&e.jsx(Me,{placement:"auto-start",container:n,delay:{show:250,hide:400},overlay:e.jsx(Fe,{id:`ttip-${s.pid}-${r}`,children:s.pid}),children:e.jsx(fe,{bg:"secondary",className:"pid-badge",children:"PID"})})]}),e.jsx("td",{children:s.hits.fragments.map((i,a)=>i.hit&&!i.hitKind?e.jsx("mark",{children:e.jsx("strong",{children:i.text})},a):e.jsx("span",{children:i.text},a))})]},`${s.pid??s.ref??t.resource.id}-${r}`))})]}),e.jsx("div",{ref:n,className:"tooltip-mounting-point"})]})}function Sr({show:t,searchId:n,resourceId:s,result:r,viewMode:i,showDiagnostics:a,onModalClose:d}){const l=Ne(),{t:u}=te(),m=ge(p=>p.locale),{languages:g,resources:R,weblichtLanguages:x}=Is(),{numberOfResults:C,queryType:y,language:N,languageFilter:f}=As(),[b,_]=h.useState(m);h.useEffect(()=>{m&&_(m)},[m]);const j=new Intl.DisplayNames([m,"en"],{type:"language"}),[F,V]=h.useState(a);h.useEffect(()=>V(a),[a]);const[D,I]=h.useState(i);h.useEffect(()=>I(i),[i]);const S=es(r.resource),z=r.exception||r.diagnostics?.filter(p=>p.uri!==Le).length>0;function L(){return!r||r.nextRecordPosition===-1||r.numberOfRecords===-1?!1:(r.numberOfRecords===r.records.length,!0)}let k=null,K=!1;if(!x.includes(N)){if(N===we)if(r.resource.languages&&r.resource.languages.length===1)k=r.resource.languages[0];else{const p=[...new Set(r.records.map(U=>U.lang).filter(U=>U!==null))];p.length===1&&(k=p[0])}k||(console.warn("Cannot use WebLicht: unsupported language",{language:N,languageFilter:f}),K=!0)}function M(p){I(p.target.value)}function A(){if(!r)return null;if(D==="annotation-layers"&&r.hasAdvResults){const p=Ge(R,U=>U.id===r.id);return e.jsx(Nt,{data:r,resource:p})}return D==="kwic"&&(y!=="lex"||!r.isLexHits)?e.jsx(Ct,{data:r}):D==="lexical-entry"&&r.hasLexResults?e.jsx(It,{data:r}):y==="lex"&&r.isLexHits?e.jsx(Tt,{data:r}):e.jsx(_t,{data:r})}return e.jsxs(se,{show:t,onHide:()=>d(),size:"xl",fullscreen:"lg-down",centered:!0,className:"resource-search-result-modal",children:[e.jsx(se.Header,{closeButton:!0,children:e.jsx(se.Title,{children:B(r.resource.title,b)})}),e.jsxs(se.Body,{className:"resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":u("search.results.resourceInfo.infoTableAriaLabel"),children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ze}})," ",u("search.results.resourceInfo.labelInstitution")]}),e.jsx("dd",{className:"mb-0",children:B(r.resource.institution,b)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ns}})," ",u("search.results.resourceInfo.labelDescription")]}),B(r.resource.description,b)&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:B(r.resource.description,b)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Be}})," ",u("search.results.resourceInfo.labelLanguages")]})]}),e.jsx("dd",{className:"mb-0",children:r.resource.languages.map(g?p=>us(p,g,{defaultAnyLanguage:u("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:u("languageCodeToName.unknown",{ns:"common"})}):p=>p).toSorted().join(", ")}),S&&S.length>1&&e.jsx(Je,{type:"radio",name:`${r.resource.id}-result-modal-info-languages`,defaultValue:b,onChange:p=>_(p),className:"mt-2 mb-3",children:S.toSorted().map(p=>e.jsxs(De,{variant:"outline-secondary",size:"sm",id:`${r.resource.id}-result-modal-info-languages-${p}`,value:p,children:[j.of(p)," ",e.jsx("sup",{children:p})]},p))}),e.jsx("dt",{children:u("search.results.resourceInfo.labelPID")}),e.jsx("dd",{children:r.resource.handle})]}),r.resource.landingPage&&e.jsxs("a",{href:r.resource.landingPage,className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ds}})," ",u("search.results.resourceInfo.moreInformation")]}),e.jsx("hr",{}),e.jsxs(X,{className:"row-gap-2",children:[e.jsx(H,{lg:"auto",md:3,sm:6,children:e.jsx(Re,{label:u("search.results.displayOptions.viewModeLabel"),controlId:"results-view-mode",children:e.jsxs($.Select,{value:D,onChange:M,children:[e.jsx("option",{value:"plain",children:u("search.results.displayOptions.viewModeOptions.plain")}),(y!=="lex"||!r.isLexHits)&&e.jsx("option",{value:"kwic",children:u("search.results.displayOptions.viewModeOptions.kwic")}),y==="fcs"&&e.jsx("option",{value:"annotation-layers",children:u("search.results.displayOptions.viewModeOptions.annotation-layers")}),y==="lex"&&e.jsx("option",{value:"lexical-entry",children:u("search.results.displayOptions.viewModeOptions.lexical-entry")})]})})}),e.jsx(H,{lg:3,md:3,sm:6,className:"align-content-center",children:e.jsx($.Check,{disabled:!z,checked:F,onChange:()=>V(p=>!p),id:"results-modal-view-warnings-errors",label:u("search.results.displayOptions.optionShowWarningsErrors")})}),e.jsxs(H,{lg:"auto",md:6,sm:6,className:"d-flex flex-grow-1 column-gap-3 align-items-center justify-content-end",children:[e.jsxs(oe,{children:[e.jsxs(oe.Toggle,{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ot}})," ",u("search.results.buttonDownload")]}),e.jsx(oe.Menu,{children:ur.map(({id:p,label:U})=>e.jsx(oe.Item,{href:mn(l,n,s,p,N,f),className:"matomo_download",children:e.jsx(W,{i18nKey:"search.results.msgButtonDownloadOption",values:{label:u(`downloadFormats.${p}.name`,{ns:"common",defaultValue:U})}})},p))})]}),e.jsxs(Z,{disabled:K,"aria-disabled":K,href:gn(l,n,s,k,N,f),className:"matomo_link",target:"_blank",children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:lt}})," ",u("search.results.buttonSendToWeblicht")]})]})]}),e.jsx("hr",{}),e.jsx("p",{children:e.jsx(W,{i18nKey:"search.results.msgShowingXresults",values:{count:r.records.length,context:L()?"hasmore":null,total:r.numberOfRecords}})}),A()]}),F&&z&&e.jsxs(se.Body,{className:"border-top",children:[r.exception&&e.jsxs(de,{variant:"danger","aria-label":u("search.results.diagnostics.alertAriaLabel"),children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:u("search.results.diagnostics.titleException")})," ",e.jsx("span",{"aria-label":u("search.results.diagnostics.msgAriaLabel"),children:r.exception.message})]}),r.exception.cause&&e.jsx("p",{className:"mb-0 small",children:u("search.results.diagnostics.msgCause",{cause:r.exception.cause})}),r.exception.klass&&e.jsx("p",{className:"mb-0 small",children:e.jsx(W,{i18nKey:"search.results.diagnostics.msgCausedBy",values:{class:r.exception.klass}})})]}),r.diagnostics.filter(p=>p.uri!==Le).map(p=>e.jsxs(de,{variant:"warning",children:[e.jsx(de.Heading,{style:{fontSize:"1rem"},children:p.message}),p.diagnostic&&e.jsx("p",{className:"mb-0 small",children:u("search.results.diagnostics.msgDiagnosticDetails",{details:p.diagnostic})}),e.jsx("p",{className:"mb-0 small",children:e.jsx(W,{i18nKey:"search.results.diagnostics.msgDiagnosticType",values:{uri:p.uri}})})]},`${p.uri}-${p.message}-${p.diagnostic}`))]}),L()&&e.jsx(se.Footer,{className:"justify-content-center border-top py-2",children:e.jsx(yr,{searchId:n,resourceId:s,numberOfResults:C})})]})}function Rr({searchId:t,resourceId:n,resultInfo:s,viewMode:r,showResourceDetails:i,showDiagnostics:a}){const d=Ne(),{t:l}=te(),u=ge(p=>p.locale),{languages:m,resources:g}=Is(),{queryType:R}=As(),[x,C]=h.useState(u);h.useEffect(()=>{u&&C(u)},[u]);const y=new Intl.DisplayNames([u,"en"],{type:"language"}),N=h.useId(),[f,b]=h.useState(!0),[_,j]=h.useState(!1),F=s.inProgress,V=s.numberOfRecordsLoaded>0,D=s.exception||s.diagnostics?.filter(p=>p.uri!==Le).length>0,{data:I,isLoading:S,isError:z}=ve({queryKey:["search-result-details",t,n],queryFn:hn.bind(null,d,t,n),enabled:!F}),L=I?es(I.resource):[];if(F||!V&&(a&&!D||!a)||!I)return null;function k(){j(!0)}function K(){j(!1)}function M(){return I?I.numberOfRecords===-1?I.records.length:I.numberOfRecords===I.records.length&&I.nextRecordPosition===-1?`${I.records.length} / ${I.numberOfRecords}?`:`${I.records.length} / ${I.numberOfRecords}`:null}function A(){if(!I)return null;if(r==="annotation-layers"&&I.hasAdvResults){const p=Ge(g,U=>U.id===I.id);return e.jsx(Nt,{data:I,resource:p})}return r==="kwic"&&(R!=="lex"||!I.isLexHits)?e.jsx(Ct,{data:I}):r==="lexical-entry"&&I.hasLexResults?e.jsx(It,{data:I}):R==="lex"&&I.isLexHits?e.jsx(Tt,{data:I}):e.jsx(_t,{data:I})}return e.jsxs(e.Fragment,{children:[e.jsxs(E,{className:"my-1 resource-search-result",role:"group","aria-label":l("search.results.resultResourceAriaLabel",{title:I.resource.title}),children:[e.jsxs(E.Header,{className:"d-flex accordion",children:[e.jsxs("button",{type:"button",onClick:()=>b(p=>!p),"aria-controls":N,"aria-expanded":f,className:`me-3 w-auto flex-grow-1 d-block text-start collapse-toggle-btn ${f?"":"collapsed"}`,children:[e.jsx(fe,{bg:"",className:"text-bg-light border me-2 user-select-text","aria-label":l("search.results.resultCountAriaLabel"),children:M()}),e.jsx("span",{"aria-label":l("search.results.resultResourceTitleAriaLabel"),className:"user-select-text",children:B(I.resource.title,x)}),e.jsx("small",{className:"text-muted user-select-text","aria-label":l("search.results.resultResourceInstitutionAriaLabel"),children:B(I.resource.institution,x)})]}),e.jsx("div",{className:"d-inline-block ms-auto",children:e.jsxs(Z,{size:"sm",onClick:k,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:dt}})," View"]})})]}),e.jsx(Js,{in:f,children:e.jsxs("div",{id:N,children:[i&&e.jsxs(E.Body,{className:"border-bottom resource-info",children:[e.jsxs("dl",{className:"mb-0","aria-label":l("search.results.resourceInfo.infoTableAriaLabel"),children:[e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ze}})," ",l("search.results.resourceInfo.labelInstitution")]}),e.jsx("dd",{className:"mb-0",children:B(I.resource.institution,x)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Ns}})," ",l("search.results.resourceInfo.labelDescription")]}),B(I.resource.description,x)&&e.jsxs(e.Fragment,{children:[e.jsx("dd",{className:"mb-0",children:B(I.resource.description,x)}),e.jsxs("dt",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:Be}})," ",l("search.results.resourceInfo.labelLanguages")]})]}),e.jsx("dd",{className:"mb-0",children:I.resource.languages.map(m?p=>us(p,m,{defaultAnyLanguage:l("languageCodeToName.any",{ns:"common"}),defaultUnknownLanguage:l("languageCodeToName.unknown",{ns:"common"})}):p=>p).toSorted().join(", ")})]}),L&&L.length>1&&e.jsx(Je,{type:"radio",name:`${I.resource.id}-result-info-languages`,defaultValue:x,onChange:p=>C(p),className:"mt-2",children:L.toSorted().map(p=>e.jsxs(De,{variant:"outline-secondary",size:"sm",id:`${I.resource.id}-result-info-languages-${p}`,value:p,children:[y.of(p)," ",e.jsx("sup",{children:p})]},p))})]}),V&&e.jsx(E.Body,{children:A()}),a&&D&&e.jsxs(E.Body,{className:V?"border-top":"",children:[I.exception&&e.jsxs(de,{variant:"danger","aria-label":l("search.results.diagnostics.alertAriaLabel"),children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsx("span",{className:"text-uppercase",children:l("search.results.diagnostics.titleException")})," ",e.jsx("span",{"aria-label":l("search.results.diagnostics.msgAriaLabel"),children:I.exception.message})]}),I.exception.cause&&e.jsx("p",{className:"mb-0 small",children:l("search.results.diagnostics.msgCause",{cause:I.exception.cause})}),I.exception.klass&&e.jsx("p",{className:"mb-0 small",children:e.jsx(W,{i18nKey:"search.results.diagnostics.msgCausedBy",values:{class:I.exception.klass}})})]}),I.diagnostics.filter(p=>p.uri!==Le).map(p=>e.jsxs(de,{variant:"warning",children:[e.jsx(de.Heading,{style:{fontSize:"1rem"},children:p.message}),p.diagnostic&&e.jsx("p",{className:"mb-0 small",children:l("search.results.diagnostics.msgDiagnosticDetails",{details:p.diagnostic})}),e.jsx("p",{className:"mb-0 small",children:e.jsx(W,{i18nKey:"search.results.diagnostics.msgDiagnosticType",values:{uri:p.uri}})})]},`${p.uri}-${p.message}-${p.diagnostic}`))]})]})})]}),e.jsx(Sr,{show:_,searchId:t,resourceId:n,result:I,viewMode:r,showDiagnostics:a,onModalClose:K})]})}const Lr="plain",Nr="lexical-entry",Cr="plain",Ir="default",Tr={default:()=>()=>0,"title-up":t=>(n,s)=>{const r=ne.getState().locale,i=B(t.get(n.id)?.title??null,r)??"",a=B(t.get(s.id)?.title??null,r)??"";return i.localeCompare(a)},"title-down":t=>(n,s)=>{const r=ne.getState().locale,i=B(t.get(n.id)?.title??null,r)??"",a=B(t.get(s.id)?.title??null,r)??"";return-i.localeCompare(a)},"result-count-total-up":()=>(t,n)=>{const s=t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded,r=n.numberOfRecords!==-1?n.numberOfRecords:n.numberOfRecordsLoaded;return s-r},"result-count-total-down":()=>(t,n)=>{const s=t.numberOfRecords!==-1?t.numberOfRecords:t.numberOfRecordsLoaded;return(n.numberOfRecords!==-1?n.numberOfRecords:n.numberOfRecordsLoaded)-s}},$s=1500;function _r({searchId:t,pollDelay:n=$s}){const{t:s}=te(),r=Ne(),{resources:i}=Is(),{query:a,queryType:d,resourceIDs:l}=As(),[u,m]=h.useState(d==="lex"?Nr:d==="fcs"?Cr:Lr),[g,R]=h.useState(Ir),[x,C]=h.useState(""),[y,N]=h.useState(!1),[f,b]=h.useState(!1),_=h.useMemo(()=>{const o=new Map;return i?.forEach(w=>{o.set(w.id,w)}),Tr[g](o)},[g,i]);n??=$s;const{data:j}=ve({queryKey:["search-results",t],queryFn:dn.bind(null,r,t??""),enabled:!!t,refetchInterval(o){return o.state.data&&o.state.data.inProgress>0?n:!1}}),F=h.useMemo(()=>j?.results.toSorted(_)||[],[j,_]),V=d==="lex"&&j?.results.every(o=>o.numberOfRecords<=0||o.isLexHits===!0),D=l.length,I=j?.inProgress??D,S=h.useMemo(()=>j?.results.filter(o=>(o.numberOfRecords!==-1?o.numberOfRecords:o.numberOfRecordsLoaded)>0).length??0,[j]),z=h.useMemo(()=>j?.results.filter(o=>!o.inProgress&&(o.numberOfRecords!==-1?o.numberOfRecords:o.numberOfRecordsLoaded)>0&&o.diagnostics.filter(w=>w.uri!==Le).length>0).length??0,[j]),L=h.useMemo(()=>j?.results.filter(o=>!o.inProgress&&(o.numberOfRecords!==-1?o.numberOfRecords:o.numberOfRecordsLoaded)<=0&&o.diagnostics.filter(w=>w.uri!==Le).length===0&&o.exception===null).length??0,[j]),k=h.useMemo(()=>j?.results.filter(o=>!o.inProgress&&(o.numberOfRecords!==-1?o.numberOfRecords:o.numberOfRecordsLoaded)<=0&&(o.diagnostics.filter(w=>w.uri!==Le).length>0||o.exception!==null)).length??0,[j]),K=h.useMemo(()=>j?.results.filter(o=>!o.inProgress&&o.numberOfRecords<=0&&o.exception!==null).length??0,[j]),M=h.useMemo(()=>j?.results.filter(o=>!o.inProgress&&(o.numberOfRecords!==-1?o.numberOfRecords:o.numberOfRecordsLoaded)<=0&&o.diagnostics.filter(w=>w.uri!==Le).length>0&&o.exception===null).length??0,[j]),A=h.useMemo(()=>j?.results.map(o=>o.numberOfRecords!==-1?o.numberOfRecords:o.numberOfRecordsLoaded).reduce((o,w)=>o+w,0)??0,[j]),p=h.useMemo(()=>j?.results.map(o=>o.numberOfRecordsLoaded).reduce((o,w)=>o+w,0)??0,[j]);{const[o,w]=h.useState(!1);h.useEffect(()=>{j&&I===0&&(o||(w(!0),rt(a,d,p)))},[j,I,a,d,t,o,p])}function U(o){m(o.target.value)}function P(o){R(o.target.value)}return e.jsxs("div",{id:"search-results",className:"mt-2 mb-4",children:[e.jsx(Me,{placement:"auto",overlay:e.jsxs(hs,{id:"search-progress-information-popover",children:[e.jsx(hs.Header,{children:s("search.results.progressPopover.title")}),e.jsxs(hs.Body,{style:{textIndent:"2rem hanging"},children:[e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesRequested",count:D})}),I>0&&e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesRequestedPending",count:I})}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithoutResults",count:L+k})}),e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsOK",count:L})}),M>0&&e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsWarnings",count:M})}),K>0&&e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithoutResultsErrors",count:K})}),e.jsx("hr",{className:"mt-2 mb-1"}),e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithResults",count:S})}),z>0&&e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithResultsWarnings",count:z})}),e.jsx("hr",{className:"mt-2 mb-0"}),e.jsx("hr",{className:"mt-1 mb-1"}),e.jsx("div",{children:e.jsx(W,{i18nKey:"search.results.progressPopover.numResourcesWithResultsTotal",count:p,values:{available:A}})})]})]}),children:e.jsxs(ns,{className:"mb-3",children:[e.jsx(ns,{variant:"success",now:S,max:D,label:e.jsx("span",{children:s("search.results.progressBar.numWithResults",{count:S})}),"aria-label":s("search.results.progressBar.numWithResultsAriaLabel")}),e.jsx(ns,{variant:"secondary",now:L+k,max:D,label:e.jsx("span",{children:s("search.results.progressBar.numWithResults",{count:L+k})}),"aria-label":s("search.results.progressBar.numWithoutResultsAriaLabel")}),e.jsx(ns,{striped:!0,animated:!0,now:I,max:D,label:e.jsx("span",{children:s("search.results.progressBar.numResultsPending",{count:I})}),"aria-label":s("search.results.progressBar.numResultsPendingAriaLabel")})]})}),e.jsx(E,{className:"mb-2",role:"group","aria-label":s("search.results.displayOptions.cardAriaLabel"),children:e.jsx(E.Body,{children:e.jsxs(X,{className:"row-gap-2",children:[e.jsx(H,{lg:"auto",md:6,sm:6,children:e.jsx(Re,{label:s("search.results.displayOptions.viewModeLabel"),controlId:"results-view-mode",children:e.jsxs($.Select,{value:u,onChange:U,children:[e.jsx("option",{value:"plain",children:s("search.results.displayOptions.viewModeOptions.plain")}),(d!=="lex"||!V)&&e.jsx("option",{value:"kwic",children:s("search.results.displayOptions.viewModeOptions.kwic")}),d==="fcs"&&e.jsx("option",{value:"annotation-layers",children:s("search.results.displayOptions.viewModeOptions.annotation-layers")}),d==="lex"&&e.jsx("option",{value:"lexical-entry",children:s("search.results.displayOptions.viewModeOptions.lexical-entry")})]})})}),e.jsx(H,{lg:"auto",md:6,sm:6,children:e.jsx(Re,{label:s("search.results.displayOptions.sortingLabel"),controlId:"results-sorting",children:e.jsxs($.Select,{value:g,onChange:P,children:[e.jsx("option",{value:"default",children:s("search.results.displayOptions.sortingOptions.default")}),e.jsx("option",{value:"title-up",children:s("search.results.displayOptions.sortingOptions.title-up")}),e.jsx("option",{value:"title-down",children:s("search.results.displayOptions.sortingOptions.title-down")}),e.jsx("option",{value:"result-count-total-up",children:s("search.results.displayOptions.sortingOptions.result-count-total-up")}),e.jsx("option",{value:"result-count-total-down",children:s("search.results.displayOptions.sortingOptions.result-count-total-down")})]})})}),e.jsx(H,{lg:"auto",md:12,sm:6,className:"flex-fill order-xl-4",children:e.jsx(Re,{label:s("search.results.displayOptions.resultFilterQueryLabel"),controlId:"result-filter",children:e.jsx(Rt,{disabled:g!=="default"||!0,value:x,onChange:o=>C(o)})})}),e.jsxs(H,{lg:"auto",md:12,sm:12,className:"align-content-center order-xl-3",children:[e.jsx($.Check,{checked:y,onChange:()=>N(o=>!o),id:"results-view-resource-details",label:s("search.results.displayOptions.optionShowResultDetails")}),e.jsx($.Check,{checked:f,onChange:()=>b(o=>!o),id:"results-view-warnings-errors",label:s("search.results.displayOptions.optionShowWarningsErrors")})]})]})})}),t&&j&&F.map(o=>e.jsx(Rr,{searchId:t,resourceId:o.id,resultInfo:o,viewMode:u,showResourceDetails:y,showDiagnostics:f},`${t}-${o.id}`))]})}const Ar=""+new URL("assets/logo-fcs-dark.png",import.meta.url).href,zs=""+new URL("assets/logo-fcs.png",import.meta.url).href;function Er(){const t=Ne(),{t:n}=te(),[s,r]=Ue(),[i,a]=h.useState([]),[d,l]=h.useState({}),[u,m]=h.useState([]),[g,R]=h.useState(null),[x,C]=h.useState(!1),[y,N]=h.useState(null),[f,b]=h.useState([]),_=G.getState().appTitleHead,j=G.getState().isAuthenticated,F={consortia:s.get(ae)},{data:V,isLoading:D,isError:I}=ve({queryKey:["init"],queryFn:rn.bind(null,t,F)});h.useEffect(()=>{if(!V)return;const A=cs(V.resources);l(V.languages),m(V.weblichtLanguages),a(A);{const p=er(A,P=>P.availabilityRestriction==="NONE"),U=(p.get(!1)??[]).length;if(!j&&U>0){p.get(!1);const P=p.get(!0);R(P),b(o=>[...o,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[e.jsx(W,{i18nKey:"search.toasts.resourceSelection.msgAuthOnlyResourcesNotSelected",count:U}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:(p.get(!1)??[]).map(w=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:w},w))})]}),variant:"success"}])}else R(Se(A))}},[V,j,n]),h.useEffect(()=>{if(!i||i.length===0)return;const A=s.get("x-aggregation-context");if(A){try{const p=JSON.parse(A),{selected:U,unavailable:P}=Zn(i,p);U.length>0&&(R(U),b(o=>[...o,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[e.jsx(W,{i18nKey:"search.toasts.resourceSelection.msgPreselectedResources",count:U.length}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:U.map(w=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:w}))})]}),variant:"success"}])),P.length>0&&b(o=>[...o,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[e.jsx(W,{i18nKey:"search.toasts.resourceSelection.msgUnableToSelectResources",count:P.length}),e.jsx("br",{}),e.jsx("ul",{className:"ps-3",children:P.map(w=>e.jsx("li",{style:{wordBreak:"break-all",fontSize:"0.7rem"},children:w}))})]}),variant:"warning"}])}catch(p){console.error('Error trying to parse "x-aggregation-context" search parameter!',{aggregationContext:A},p),p instanceof Error&&b(U=>[...U,{title:n("search.toasts.resourceSelection.title"),body:e.jsxs(e.Fragment,{children:[n("search.toasts.resourceSelection.msgErrorUnableToSelectResources",{error:p.name}),e.jsx("br",{}),e.jsx("small",{children:p.message})]}),variant:"error"}])}s.delete("x-aggregation-context"),r(s)}},[i,s,r,n]);const S=D||I,{mutate:z,data:L,isPending:k}=Ys({mutationKey:["search"],mutationFn:({query:A,queryType:p,language:U,numberOfResults:P,resourceIDs:o})=>ln(t,{query:A,queryType:p,language:U,numberOfResults:P.toString(),resourceIds:o})});function K(A){R(A.resourceIDs),N(A),C(!0),rt(A.query,A.queryType),z(A)}function M(A){b(p=>[...p,A])}return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{children:e.jsx("title",{children:_})}),e.jsxs(ie,{id:"search",children:[e.jsx("div",{"aria-live":"polite","aria-atomic":"true",className:"bg-dark position-relative",children:e.jsx(Xt,{position:"top-end",className:"mt-2",style:{zIndex:100},children:f.map((A,p)=>e.jsxs(ms,{bg:A.variant,onClose:()=>b(U=>U.filter(P=>P!==A)),delay:A.delay??5e3,autohide:!0,children:[e.jsx(ms.Header,{closeButton:!0,children:e.jsx("strong",{className:"me-auto",children:A.title})}),e.jsx(ms.Body,{children:A.body})]},p))})}),!x&&e.jsx(X,{children:e.jsx(H,{className:"text-center",children:e.jsxs("picture",{children:[e.jsx("source",{srcSet:zs,media:"(prefers-color-scheme: light)"}),e.jsx("source",{srcSet:Ar,media:"(prefers-color-scheme: dark)"}),e.jsx("img",{src:zs,className:"logo",alt:"FCS logo"})]})})}),e.jsx(X,{className:"mt-3",children:e.jsx(H,{children:e.jsx(br,{resources:i,languages:d,availableResources:null,selectedResources:g,onSearch:K,onShowToast:M,hasSearch:x,disabled:S})})}),!x&&e.jsx(X,{className:"mt-3",children:e.jsxs(H,{children:[e.jsx("p",{children:e.jsx(W,{i18nKey:"search.intro.textGeneral"})}),e.jsx("p",{children:e.jsx(W,{i18nKey:"search.intro.textLearnMore",components:[e.jsxs("a",{href:n("search.intro.url"),children:["page ",e.jsx("em",{children:"Content Search"})," at CLARIN.eu"]})]})})]})}),x&&k&&e.jsx(X,{children:e.jsx(H,{className:"text-center my-5",children:e.jsx(Zs,{animation:"border"})})}),y&&L&&e.jsx(Qn,{resources:i,languages:d,weblichtLanguages:u,children:e.jsx(Yn,{...y,children:e.jsx(_r,{searchId:L})})})]})]})}function Mr(){const t=Gs(),[n]=ke();return h.useCallback((r,i,a)=>{const d=Dt(r,i);t({pathname:d,search:n},a)},[t,n])}function kr(){const t=h.useContext(Ft),n=Rs(),s=t.matches.map(i=>i.route),r=Bt(s,n);return r!==null&&r.length>0?r[0]:null}function Pr(t){const n=h.useRef();return h.useEffect(()=>{n.current=t}),n.current}const Te="resource",Or="institution",Hr="url";function At(t){const n=new URL(t).hostname,s=n.split(".");if(s.length<=1)return n;const r=s.at(-1);if(s.length===2)return r;const i=s.at(-2);return r.length===2&&i.length===2||r.length===3&&i.length===2?`${i}.${r}`:r}function Ur(t){const n=At(t),s=new URL(t),l=`${s.hostname.slice(0,-(n.length+1)).split(".").slice(-1)}.${n}`;return s.port?`${l}:${s.port}`:l}function Ks(t){const n=new URL(t),r=n.hostname.split(".").toReversed(),i=t.substring(t.indexOf("/",n.protocol.length+2+n.hostname.length));return[...r,n.port,i]}function gs(t,n){const s=Ks(t),r=Ks(n),i=Math.min(s.length,r.length);for(let a=0;a<i;a++){const d=s[a],l=r[a],u=d.localeCompare(l);if(u!==0)return u}return 0}function Dr(){const t=Ne(),n=Ls(),{t:s}=te(),r=ge(c=>c.locale),[,i]=ke(),[a,d]=Ue(),[l,u]=h.useState([]),[m,g]=h.useState([]),[R,x]=h.useState({}),[C,y]=h.useState(Or),[N,f]=h.useState(Hr),[b,_]=h.useState(!1),j=a.get(ae)?.split(",")??[],F={consortia:a.get(ae)},{data:V,isPending:D,isError:I,error:S}=ve({queryKey:["resources"],queryFn:ps.bind(null,t,F)}),{data:z,isPending:L,isError:k,error:K}=ve({queryKey:["languages"],queryFn:an.bind(null,t,F)}),{data:M,isPending:A,isError:p,error:U}=ve({queryKey:["resources-all"],queryFn:ps.bind(null,t,void 0)});h.useEffect(()=>{if(!V)return;const c=cs(V);u(c)},[V]),h.useEffect(()=>{z&&x(z)},[z]);{h.useEffect(()=>{M&&g(cs(M))},[M]);const c=a.get(ae),v=Pr(c);h.useEffect(()=>{const T=a.get(ae);v!==T&&n.invalidateQueries()},[v,n,a])}const P=ys(l),o=P.reduce((c,v)=>{const T=v.endpoint.url;return c.has(T)||c.set(T,[]),c.get(T).push(v),c},new Map),w=Array.from(o.keys()).reduce((c,v)=>{const T=Ur(v);return c.has(T)||c.set(T,[]),c.get(T).push(v),c},new Map),J=Array.from(o.keys()).reduce((c,v)=>{const T=At(v);return c.has(T)||c.set(T,[]),c.get(T).push(v),c},new Map),Y=P.reduce((c,v)=>{const T=B(v.institution,r)??v.endpointInstitution.name;return c.has(T)||c.set(T,[]),c.get(T).push(v),c},new Map),ee=P.reduce((c,v)=>{const T=v.endpointInstitution.name;return c.has(T)||c.set(T,[]),c.get(T).push(v),c},new Map),pe=P.reduce((c,v)=>{const T=v.searchCapabilitiesResolved;for(const q of T)c.has(q)||c.set(q,[]),c.get(q).push(v);return c},new Map),je=P.reduce((c,v)=>{const T=v.availabilityRestriction;return c.has(T)||c.set(T,[]),c.get(T).push(v),c},new Map),Ve=ys(m).reduce((c,v)=>{const T=v.endpointInstitution.consortium??null;c.has(T)||c.set(T,{resources:[],endpoints:new Set});const q=c.get(T);return q.resources.push(v),q.endpoints.add(v.endpoint.url),c},new Map),Pe=l&&l.length>0,be=R&&Object.getOwnPropertyNames(R).length>0,Oe=Pe&&be,He=Array.from(je.keys()).filter(c=>c!=="NONE").length>0;function Ce(c){const v=a.get(ae)?.split(",").filter(Boolean)??[],T=v.includes(c)?v.filter(q=>q!==c):v.concat([c]);T.length===0?a.delete(ae):a.set(ae,T.join(",")),d(a)}function $e(){return N==="tld"?e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thEndpointDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountURLsForDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResources")})]})}),e.jsx("tbody",{children:Array.from(J.entries()).toSorted(([c],[v])=>gs(`http://${c}`,`http://${v}`)).map(([c,v])=>{const T=v.map(q=>o.get(q)).flat();return e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsx("td",{children:v.length}),e.jsx("td",{children:T.length})]},c)})})]}):N==="domain"?e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thEndpointDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountURLsForDomain")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResources")})]})}),e.jsx("tbody",{children:Array.from(w.entries()).toSorted(([c],[v])=>gs(`http://${c}`,`http://${v}`)).map(([c,v])=>{const T=v.map(q=>o.get(q)).flat();return e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsx("td",{children:v.length}),e.jsx("td",{children:T.length})]},c)})})]}):e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thEndpointUrl")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResources")})]})}),e.jsx("tbody",{children:Array.from(o.entries()).toSorted(([c],[v])=>gs(c,v)).map(([c,v])=>e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsx("td",{children:v.length})]},c))})]})}return e.jsxs(ie,{className:"d-grid gap-2 mt-3",children:[(D||I)&&e.jsx(X,{children:e.jsxs(H,{children:[D?s("statistics.loading",{context:"what",what:"resources"}):null,e.jsx("br",{}),I?S.message:null]})}),(L||k)&&e.jsx(X,{children:e.jsxs(H,{children:[L?s("statistics.loading",{context:"what",what:"languages"}):null,e.jsx("br",{}),k?K.message:null]})}),e.jsx(e.Fragment,{children:(A||p)&&e.jsx(X,{children:e.jsxs(H,{children:[A?s("statistics.loading",{context:"what",what:"resources-all"}):null,e.jsx("br",{}),p?U.message:null]})})}),e.jsxs(E,{className:"p-3",children:[e.jsx("h3",{className:"h4 pb-1 mb-3 border-bottom",children:s("statistics.fcs.title")}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"overview",children:s("statistics.fcs.titleOverall")}),e.jsxs(re,{hover:!0,responsive:!0,children:[e.jsx("thead",{className:"visually-hidden",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thStatsKey")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thStatsValue")})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:s("statistics.fcs.tdLabelResourceCount")}),e.jsx("td",{children:P.length})]}),e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:s("statistics.fcs.tdLabelEndpointCount")}),e.jsx("td",{children:o.size})]}),e.jsxs("tr",{children:[e.jsx("td",{scope:"row",children:s("statistics.fcs.tdLabelInstitutionCount")}),e.jsx("td",{children:ee.size})]})]})]}),e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"consortia",children:s("statistics.fcs.titleConsortia")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderConsortia")}),e.jsx(E.Body,{children:e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thConsortium")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountEndpoints")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResources")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thActions")})]})}),e.jsx("tbody",{children:Array.from(Ve.entries()).map(([c,{resources:v,endpoints:T}])=>e.jsxs("tr",{className:c&&j.includes(c)?"table-primary":void 0,children:[e.jsx("td",{children:c??s("statistics.fcs.tdNoConsortium")}),e.jsx("td",{children:T.size}),e.jsx("td",{children:v.length}),e.jsx("td",{className:c===null?"":"py-0 align-middle",children:c===null?"â€“":e.jsx(Z,{size:"sm",onClick:()=>Ce(c),children:s("statistics.fcs.btnToggleConsortium",{context:j.includes(c)?"remove":"add"})})})]},c))})]})})]})]}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"institutions",children:s("statistics.fcs.titleInstitutions")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderInstitutionStats")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.fcs.tdLabelInstitutionCount")}),e.jsx("dd",{children:Y.size}),e.jsx("dt",{children:s("statistics.fcs.tdLabelInstitutionHosterCount")}),e.jsx("dd",{children:ee.size})]})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderInstitutions")}),e.jsxs(E.Body,{children:[e.jsx($,{onSubmit:c=>c.preventDefault(),children:e.jsxs(H,{className:"filter-checkboxes",lg:12,md:12,children:[e.jsx($.Text,{className:"me-2",children:s("statistics.fcs.labelForResourceInstitutionVariants")}),["institution","hoster"].map(c=>e.jsx($.Check,{type:"radio",name:"resourceInstitutionVariant",value:c,id:`resourceInstitutionVariant-${c}`,checked:C===c,onChange:()=>y(c),label:s(`statistics.fcs.resourceInstitutionVariant${c}`)},c))]})}),e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thInstitutionName")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResources")})]})}),e.jsx("tbody",{children:Array.from((C==="hoster"?ee:Y).entries()).map(([c,v])=>e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsx("td",{children:v.length})]},c))})]})]})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",id:"endpoints",children:s("statistics.fcs.titleEndpoints")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderEndpointStats")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.fcs.tdLabelEndpointCount")}),e.jsx("dd",{children:o.size}),e.jsx("dt",{children:s("statistics.fcs.tdLabelEndpointDomainCount")}),e.jsx("dd",{children:w.size})]})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderEndpoints")}),e.jsxs(E.Body,{children:[e.jsx($,{onSubmit:c=>c.preventDefault(),children:e.jsxs(H,{className:"filter-checkboxes",lg:12,md:12,children:[e.jsx($.Text,{className:"me-2",children:s("statistics.fcs.labelForResourceInstitutionVariants")}),["url","domain","tld"].map(c=>e.jsx($.Check,{type:"radio",name:"endpointURLVariant",value:c,id:`endpointURLVariant-${c}`,checked:N===c,onChange:()=>f(c),label:s(`statistics.fcs.endpointURLVariant${c}`)},c))]})}),$e()]})]}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",id:"resources",children:s("statistics.fcs.titleResources")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderResourceStats")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.fcs.tdLabelResourceCount")}),e.jsx("dd",{children:P.length}),e.jsx("dt",{children:s("statistics.fcs.tdLabelRootResourceCount")}),e.jsx("dd",{children:l.length}),e.jsx("dt",{children:s("statistics.fcs.tdLabelResourceWithAvailabilityRestrictionCount")}),e.jsx("dd",{children:Array.from(je.entries()).filter(([c])=>c!=="NONE").map(([,c])=>c).flat().length})]})}),Oe&&e.jsx(E.Footer,{className:"d-flex gap-2",children:e.jsx(Z,{variant:"primary",onClick:()=>_(!0),children:s("statistics.fcs.btnOpenResourceLanguageSelectionModal")})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderSearchCapabilities")}),e.jsx(E.Body,{children:e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thSearchCapability")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thCountResources")})]})}),e.jsx("tbody",{children:Array.from(pe.entries()).map(([c,v])=>e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsx("td",{children:v.length})]},c))})]})})]}),He&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.fcs.cardHeaderResourcesWithAvailabilityRestrictions")}),e.jsx(E.Body,{children:e.jsxs(re,{hover:!0,responsive:!0,className:"mt-2",children:[e.jsx("caption",{children:s("statistics.fcs.tblAvailabilityRestrictionCaption")}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.fcs.thAvailabilityRestriction")}),e.jsx("th",{scope:"col",children:s("statistics.fcs.thResourceTitle")})]})}),e.jsx("tbody",{children:Array.from(je.entries()).filter(([c])=>c!=="NONE").map(([c,v])=>v.map(T=>e.jsxs("tr",{children:[e.jsx("td",{children:c}),e.jsxs("td",{children:[B(T.title,r)," ",e.jsx(_e,{to:{pathname:"/stats/resources",search:i({[Te]:T.id})},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae},className:"align-baseline ms-2"})})]})]},T.id)))})]})})]})]}),e.jsx(St,{languages:R,resources:l,showResourceCounts:!0,showLanguageFilterOptions:!1,show:b,onModalClose:()=>_(!1)})]})}function Fr({validatorUrl:t}){const n=Ne(),{t:s}=te(),r=ge(o=>o.locale),[i,a]=h.useState(r),d=new Intl.DisplayNames([r,"en"],{type:"language"}),[,l]=ke(),[u,m]=Ue(),[g,R]=h.useState([]),[x,C]=h.useState(""),[y,N]=h.useState(u.get(Te)),f=Ge(g,o=>o.id===y);if(f===void 0){const o=Ge(g,w=>w.handle===y);if(o!==void 0){const w=o.id;w!==y&&(N(w),u.set(Te,w),m(u))}}const b=y?f:void 0,_={consortia:u.get(ae)},{data:j,isPending:F,isError:V,error:D}=ve({queryKey:["resources"],queryFn:ps.bind(null,n,_)});h.useEffect(()=>{if(!j)return;const o=cs(j);R(o)},[j]),h.useEffect(()=>{const o=u.get(Te);o&&o!==y&&N(o)},[u,y]);const S=g.map(o=>es(o)).flat().reduce((o,w)=>o.set(w,(o.get(w)??0)+1),new Map),z=g.toSorted(bt["title-up"]),{resources:L,matches:k}=Lt(x,z,i,["title","institution"]);function K(o){if(!o)return;const w=o;N(w),u.set(Te,w),m(u)}function M(o,w,J=0){const Y=w?.get(o.id)??new Map,ee=e.jsx(oe.Item,{eventKey:o.id,style:{paddingInlineStart:`${1+J*1}em`},children:e.jsx(ue.Highlight,{text:B(o.title,i)??"",ranges:Y.get("title")??null})},o.id);return o.subResources&&o.subResources.length>0?e.jsxs(h.Fragment,{children:[ee,o.subResources.map(pe=>M(pe,k,J+1))]},o.id):ee}function A(o,w,J="â€“"){if(w===null)return null;const Y=ir(w,r);return e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s(`statistics.resources.cardHeader${o[0].toUpperCase()}${o.slice(1)}`)}),typeof w=="string"?e.jsx(E.Body,{children:w||J}):e.jsx(Qe,{className:"list-group-flush",children:Object.entries(w).map(([ee,pe])=>e.jsxs(Qe.Item,{children:[e.jsxs(fe,{bg:Y===ee?"primary":"secondary",className:"me-2",children:[d.of(ee)," ",e.jsx("sup",{children:ee})]})," ",pe||J]},ee))})]})}function p(o){if(!g||!o)return null;const w=o.rootResourceId===null?o:Ge(g,Y=>Y.id===o.rootResourceId);if(!w)return null;function J(Y){return e.jsxs("li",{children:[Y.id===o.id?e.jsx("strong",{children:Y.handle}):e.jsxs(e.Fragment,{children:[Y.handle,e.jsx(_e,{to:{search:l({[Te]:Y.id})},onClick:ee=>{ee.preventDefault(),K(Y.id)},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae},className:"align-baseline ms-2 me-1"})})]})," ","â€“ ",B(Y.title,r),Y.subResources.length>0&&e.jsx("ul",{children:Y.subResources.map(ee=>J(ee))})]},Y.id)}return e.jsx("ul",{children:J(w)})}const U=b&&(b.availableDataViews?.find(o=>o.mimeType==="application/x-clarin-fcs-lex+xml")||b.availableLexFields&&b.availableLexFields.length>0),P=b&&(b.availableDataViews?.find(o=>o.mimeType==="application/x-clarin-fcs-adv+xml")||b.availableLayers&&b.availableLayers.length>0);return e.jsxs(ie,{className:"d-grid gap-2 mt-3",children:[(F||V)&&e.jsx(X,{children:e.jsxs(H,{children:[F?s("statistics.loading"):null,e.jsx("br",{}),V?D.message:null]})}),e.jsx($,{onSubmit:o=>o.preventDefault(),children:e.jsxs(oe,{onSelect:K,children:[e.jsxs(oe.Toggle,{className:"resource-selector",variant:"outline-dark",children:[s("statistics.resources.dropdownLabel",{count:g.length})," "]}),e.jsxs(oe.Menu,{children:[e.jsxs(oe.ItemText,{children:[e.jsx($.Control,{value:x,onChange:o=>C(o.target.value)}),S.size>1&&e.jsxs($.Group,{as:X,controlId:"resource-info-language",className:"mt-2",children:[e.jsx($.Label,{column:!0,sm:"auto",style:{fontSize:"0.875rem"},children:s("search.resourcesModal.labelChangeResourceInfoLanguage")}),e.jsx(H,{sm:"auto",children:e.jsx(Je,{type:"radio",name:"resource-info-languages",defaultValue:i,onChange:o=>a(o),children:Array.from(S.entries()).toSorted().map(([o,w])=>e.jsxs(De,{size:"sm",id:`resource-info-languages-${o}`,value:o,variant:"secondary",title:s("search.resourcesModal.buttonChangeResourceInfoLanguageTitle",{count:w,language:o,languageName:d.of(o)}),children:[d.of(o)," ",e.jsx("sup",{children:o})]},o))})})]})]}),e.jsx(oe.Divider,{}),L.map(o=>M(o,k))]})]})}),b&&e.jsxs(E,{className:"p-3 mt-3",children:[e.jsx("h3",{className:"h4 pb-1 mb-3 border-bottom",children:B(b.title,r)}),e.jsx("h4",{className:"h5 pb-1 mb-3 border-bottom",children:s("statistics.resources.titleBasicMetadata")}),A("title",b.title),A("description",b.description),A("institution",b.institution),b.landingPage&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.resources.cardHeaderLandingPage")}),e.jsx(E.Body,{children:e.jsx("a",{href:b.landingPage,className:"matomo_link",target:"_blank",children:b.landingPage})})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",children:s("statistics.resources.titleTechnicalMetadata")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.resources.cardHeaderResource")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.labels.resourcePid")}),e.jsx("dd",{children:b.handle}),e.jsx("dt",{children:s("statistics.labels.resourceHierarchy")}),e.jsx("dd",{children:p(b)}),e.jsx("dt",{children:s("statistics.labels.searchCapabilitiesOfResource")}),e.jsx("dd",{children:b.searchCapabilitiesResolved.join(", ")}),e.jsx("dt",{children:s("statistics.labels.availabilityRestriction")}),e.jsx("dd",{children:b.availabilityRestriction})]})})]}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.resources.cardHeaderEndpoint")}),e.jsx(E.Body,{children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.labels.endpointUrl")}),e.jsxs("dd",{children:[b.endpoint.url," ",t&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${t}?url=${encodeURIComponent(b.endpoint.url)}`,className:"matomo_link",target:"_blank",children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae},className:"align-baseline ms-2"})})]})]}),e.jsx("dt",{children:s("statistics.labels.fcsVersion")}),e.jsx("dd",{children:b.endpoint.protocol}),e.jsx("dt",{children:s("statistics.labels.searchCapabilitiesOfEndpoint")}),e.jsx("dd",{children:b.endpoint.searchCapabilities.join(", ")}),e.jsx("dt",{children:s("statistics.labels.endpointInstitution")}),e.jsxs("dd",{children:[b.endpointInstitution.name,b.endpointInstitution.link&&e.jsxs(e.Fragment,{children:[" â€“ ",e.jsxs("a",{href:b.endpointInstitution.link,className:"matomo_link",target:"_blank",children:[s("statistics.labels.moreInformation")," ",e.jsx("i",{dangerouslySetInnerHTML:{__html:ds}})]})]})]})]})})]}),e.jsx("h4",{className:"h5 pb-1 mt-4 mb-3 border-bottom",children:s("statistics.resources.titleSeachInformation")}),e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.resources.cardHeaderDataViews")}),e.jsx(E.Body,{children:b.availableDataViews&&e.jsxs(re,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.resources.thDataViewIdentifier")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thDataViewMimeType")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thDataViewDeliveryPolicy")})]})}),e.jsx("tbody",{children:b.availableDataViews.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.identifier}),e.jsx("td",{children:o.mimeType}),e.jsx("td",{children:o.deliveryPolicy})]},o.identifier))})]})})]}),P&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.resources.cardHeaderAdvancedDataView")}),e.jsx(E.Body,{children:b.availableLayers&&e.jsxs(re,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.resources.thLayerType")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thQualifier")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thResultId")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thIdentifier")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thEncoding")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thAltValueInfo")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thAltValueInfoURI")})]})}),e.jsx("tbody",{children:b.availableLayers.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.layerType}),e.jsx("td",{children:o.qualifier}),e.jsx("td",{children:o.resultId}),e.jsx("td",{children:o.identifier}),e.jsx("td",{children:o.encoding}),e.jsx("td",{children:o.altValueInfo}),e.jsx("td",{children:o.altValueInfoURI})]},o.identifier))})]})})]}),U&&e.jsxs(E,{className:"my-2",children:[e.jsx(E.Header,{children:s("statistics.resources.cardHeaderLexDataView")}),e.jsx(E.Body,{children:b.availableLexFields&&e.jsxs(re,{hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:s("statistics.resources.thLexFieldType")}),e.jsx("th",{scope:"col",children:s("statistics.resources.thLexIdentifier")})]})}),e.jsx("tbody",{children:b.availableLexFields.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.type}),e.jsx("td",{children:o.id})]},o.id))})]})})]})]})]})}function Br({url:t,statistics:n,validatorUrl:s,isScan:r}){const{t:i,i18n:a}=te(),[,d]=ke(),l=new Intl.NumberFormat(a.language,{style:"unit",unit:"second",unitDisplay:"short"});function u(m,g){const R=e.jsx(ue.Highlight,{text:m.title,ranges:n.matchResources?.[g]??null}),x=e.jsx(_e,{to:{pathname:"/stats/resources",search:d({[Te]:m.handle})},children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae},className:"align-baseline ms-2"})});return m.valid&&m.notes.length===0?e.jsxs(e.Fragment,{children:[R," ",x]}):e.jsx(Me,{placement:"auto-start",delay:{show:250,hide:400},overlay:e.jsxs(Fe,{id:`resource-info-warning-${m.handle}`,children:[!m.valid&&i("statistics.errors.notAvailableInAggregator"),!m.valid&&m.notes.length>=1&&e.jsx("hr",{className:"mt-2 mb-1"}),m.notes.length===1?m.notes[0]:m.notes.length>=1?e.jsx("ul",{className:"text-start m-0 my-1 ps-3",children:m.notes.map((C,y)=>e.jsx("li",{children:C},y))}):null]}),children:e.jsxs("span",{children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:ct},className:"align-baseline me-2"}),m.valid?R:e.jsx("s",{children:R})," ",x]})})}return e.jsxs("div",{className:"ps-sm-4 mt-sm-0 mt-2 pt-sm-0 pt-1",children:[e.jsxs("h4",{className:"h5",id:`${Xs(t)}-${r?"scan":"search"}`,children:[e.jsx(ue.Highlight,{text:t,ranges:n.matchEndpoint}),s&&e.jsxs(e.Fragment,{children:[" ",e.jsx("a",{href:`${s}?url=${encodeURIComponent(t)}`,children:e.jsx("i",{dangerouslySetInnerHTML:{__html:Ae},className:"align-baseline ms-2"})})]})]}),e.jsxs("dl",{className:"ps-sm-4",children:[e.jsx("dt",{children:i("statistics.labels.fcsVersion")}),e.jsx("dd",{children:n.version}),e.jsx("dt",{children:i("statistics.labels.searchCapabilities")}),e.jsx("dd",{children:n.searchCapabilities.join(", ")}),e.jsx("dt",{children:i("statistics.labels.maxConcurrentScanRequests")}),e.jsx("dd",{children:n.maxConcurrentRequests}),e.jsx("dt",{children:i("statistics.labels.requestStatistics")}),e.jsx("dd",{className:"mb-0",children:i("statistics.labels.numberOfRequests",{count:n.numberOfRequests})}),n.avgQueueTime!==0&&e.jsx("dd",{className:"mb-0",children:i("statistics.labels.queueTime",{avg:l.format(n.avgQueueTime),max:l.format(n.maxQueueTime)})}),e.jsx("dd",{children:i("statistics.labels.executionTime",{avg:l.format(n.avgExecutionTime),max:l.format(n.maxExecutionTime)})}),n.rootResources?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{children:i("statistics.labels.resources")}),e.jsx("dd",{children:i("statistics.labels.numberOfRootResources",{count:n.rootResources.length})}),e.jsx("dd",{children:e.jsx("ul",{children:n.rootResources.map((m,g)=>typeof m=="string"?e.jsx("li",{children:e.jsx(ue.Highlight,{text:m,ranges:n.matchResources?.[g]??null})},m):e.jsx("li",{children:u(m,g)},m.handle))})})]}),e.jsxs(e.Fragment,{children:[Object.entries(n.diagnostics||{}).map(([m,g])=>e.jsxs(de,{variant:"warning",style:{fontSize:"0.85rem"},children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(fe,{bg:"warning",children:[g.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:i("statistics.diagnostic.diagnostic")})," ",g.diagnostic.message,g.diagnostic.diagnostic&&e.jsxs(e.Fragment,{children:[" - ",e.jsx("small",{children:g.diagnostic.diagnostic})]})]}),e.jsxs("p",{className:"mb-0",children:[i("statistics.diagnostic.context")," ",e.jsx("a",{href:g.context,children:g.context})]})]},m)),Object.entries(n.errors||{}).map(([m,g])=>e.jsxs(de,{variant:"danger",style:{fontSize:"0.85rem"},children:[e.jsxs(de.Heading,{style:{fontSize:"1rem"},children:[e.jsxs(fe,{bg:"danger",children:[g.counter,"x"]})," ",e.jsx("span",{className:"text-uppercase",children:i("statistics.diagnostic.exception")})," ",g.exception.message]}),e.jsxs("p",{className:"mb-0",children:[i("statistics.diagnostic.context")," ",e.jsx("a",{href:g.context,children:g.context})]}),g.exception.cause&&e.jsxs("p",{className:"mb-0",children:[i("statistics.diagnostic.causedBy")," ",g.exception.cause]})]},m))]})]})]},t)}function qr({data:t,validatorUrl:n}){const{t:s,i18n:r}=te(),[i,a]=h.useState(""),[d,l]=h.useState(["institution","endpoint","resources"]),[u,m]=h.useState(!1),g=`-${t.isScan?"scan":"search"}`,R=h.useMemo(()=>Object.entries(t.institutions).toSorted().map(([f,b])=>Object.entries(b).toSorted().map(([_,j])=>({institutionName:f,endpointUrl:_,endpointInfo:{...j,rootResources:j.rootResources.toSorted()}}))).flat(1).filter(u?f=>Object.keys(f.endpointInfo.diagnostics).length>0||Object.keys(f.endpointInfo.errors).length>0:()=>!0),[t,u]),x=R.filter(f=>Object.keys(f.endpointInfo.diagnostics).length>0||Object.keys(f.endpointInfo.errors).length>0),y=ue.useFuzzySearchList({list:R,queryText:i,getText:f=>{const b=[];return d.length===0?b.push(f.institutionName,f.endpointUrl,...f.endpointInfo.rootResources.map(_=>typeof _=="string"?_:_.title)):(d.includes("institution")&&b.push(f.institutionName),d.includes("endpoint")&&b.push(f.endpointUrl),d.includes("resources")&&b.push(...f.endpointInfo.rootResources.map(_=>typeof _=="string"?_:_.title))),b},mapResultItem:({item:f,score:b,matches:_})=>({item:f,matches:_,score:b})}).reduce((f,b)=>{const{institutionName:_,endpointUrl:j,endpointInfo:F}=b.item;return Object.getOwnPropertyNames(f).includes(_)||(f[_]={match:d.length===0||d.includes("institution")?b.matches[0]:null,endpoints:{}}),f[_].endpoints[j]={...F,matchEndpoint:d.length===0||d.includes("endpoint")?b.matches[d.length===0||d.includes("institution")?1:0]:null,matchResources:d.length===0||d.includes("resources")?b.matches.slice(0+(d.length===0||d.includes("institution")?1:0)+(d.length===0||d.includes("endpoint")?1:0)):[]},f},{});function N(f){d.includes(f)?l(d.filter(b=>b!==f)):l([...d,f])}return e.jsxs(ie,{className:"d-grid gap-2 mt-3",children:[e.jsx(de,{variant:"info",className:"mb-0",children:e.jsxs("dl",{className:"mb-0",children:[e.jsx("dt",{children:s("statistics.labels.startDate")}),e.jsx("dd",{className:"mb-0",children:new Date(t.date).toLocaleString(r.language)}),e.jsx("dt",{children:s("statistics.labels.timeout")}),e.jsx("dd",{className:"mb-0",children:new Intl.NumberFormat(r.language,{style:"unit",unit:"second",unitDisplay:"short"}).format(t.timeout)})]})}),e.jsx($,{onSubmit:f=>f.preventDefault(),children:e.jsxs(X,{className:"gy-2",children:[e.jsx(H,{lg:6,md:12,children:e.jsx($.Control,{placeholder:s("statistics.filter.inputPlaceholder"),value:i,onChange:f=>a(f.target.value)})}),e.jsxs(H,{className:"filter-checkboxes",lg:6,md:12,children:[e.jsx($.Text,{className:"me-2",children:s("statistics.filter.labelForCheckboxes")}),e.jsx($.Check,{type:"checkbox",checked:d.includes("institution"),onChange:()=>N("institution"),id:`filter-institution-name${g}`,label:s("statistics.filter.checkboxInstitution")}),e.jsx($.Check,{type:"checkbox",checked:d.includes("endpoint"),onChange:()=>N("endpoint"),id:`filter-endpoint-url${g}`,label:s("statistics.filter.checkboxEndpoint")}),e.jsx($.Check,{type:"checkbox",checked:d.includes("resources"),onChange:()=>N("resources"),id:`filter-resource-names${g}`,label:s("statistics.filter.checkboxResources")})]})]})}),e.jsx(X,{children:e.jsx(H,{children:e.jsx($.Check,{type:"checkbox",checked:u,onChange:()=>m(!u),id:`filter-show-issues-only${g}`,label:s("statistics.filter.checkboxShowWithIssues",{count:x.length})})})}),Object.entries(y).map(([f,{match:b,endpoints:_}])=>e.jsxs(E,{className:"p-2",children:[e.jsx("h3",{className:"h4 pb-1 border-bottom",id:`${Xs(f)}${g}`,children:e.jsx(ue.Highlight,{text:f,ranges:b})}),Object.entries(_).toSorted().map(([j,F])=>e.jsx(Br,{url:j,statistics:F,validatorUrl:n,isScan:t.isScan},j))]},f))]})}const Vr=[{id:"last-scan",label:"Last Scan"},{id:"recent-searches",label:"Recent Searches"}],$r=Object.fromEntries(Vr.map(t=>[t.id,t])),zr=["resources","fcs"];function Kr(){const t=Ne(),n=Ls(),[s]=Ue(),{t:r}=te(),{categoryId:i}=qt(),a=kr(),d=Mr(),l={consortia:s.get(ae)},{isPending:u,isError:m,data:g,error:R}=ve({queryKey:["statistics"],queryFn:on.bind(null,t,l)}),[x,C]=h.useState(G.getState().validatorURL);G.subscribe(j=>C(j.validatorURL));const y=G.getState().appTitleHead,N=[...g!==void 0?Object.keys(g).toSorted():[],...zr],f=i!=null&&N.includes(i)?i:N.length>0?N[0]:void 0;function b(){n.invalidateQueries({queryKey:["statistics"]}),n.invalidateQueries({queryKey:["resources"]}),n.invalidateQueries({queryKey:["languages"]}),n.invalidateQueries({queryKey:["resources-all"]}),n.invalidateQueries({queryKey:["consortia"]})}function _(j){a?.params.categoryId,a&&a.params.categoryId!==j&&a.route.path&&d(a.route.path,{categoryId:j})}return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{children:e.jsxs("title",{children:[y," â€“ Statistics"]})}),e.jsxs(ie,{id:"statistics",className:"my-4",children:[e.jsx("h1",{className:"h1",children:r("statistics.title")}),(u||m)&&e.jsx(X,{children:e.jsxs(H,{children:[u?r("statistics.loading"):null,e.jsx("br",{}),m?R.message:null]})}),g&&e.jsxs(ze.Container,{activeKey:i&&N.includes(i)?i:f,onSelect:_,children:[e.jsxs(ce,{className:"nav-tabs",as:"ul",children:[Object.keys(g).map(j=>e.jsx(ce.Item,{as:"li",role:"presentation",children:e.jsx(ce.Link,{as:"button",eventKey:j,children:r(`statistics.tabs.${j}`,{defaultValue:$r[j]?.label??j})})},j)),e.jsx(ce.Item,{as:"li",role:"presentation",children:e.jsx(ce.Link,{as:"button",eventKey:"resources",children:r("statistics.tabs.resources")})},"resources"),e.jsx(ce.Item,{as:"li",role:"presentation",children:e.jsx(ce.Link,{as:"button",eventKey:"fcs",children:r("statistics.tabs.fcs")})},"fcs"),e.jsx(ce.Item,{as:"li",role:"presentation",className:"ms-auto",children:e.jsxs(ce.Link,{as:"button",onClick:b,children:[e.jsx("i",{dangerouslySetInnerHTML:{__html:it}})," ",r("statistics.tabs.btnRefresh")]})})]}),e.jsxs(ze.Content,{children:[Object.entries(g).map(([j,F])=>e.jsx(ze.Pane,{eventKey:j,children:e.jsx(qr,{data:F,validatorUrl:x})},j)),e.jsx(ze.Pane,{eventKey:"resources",children:e.jsx(Fr,{validatorUrl:x})},"resources"),e.jsx(ze.Pane,{eventKey:"fcs",children:e.jsx(Dr,{})},"fcs")]})]})]})]})}function Wr(){const t=G.getState().appTitleHead;Rn();const n=ge(s=>s.locale);h.useEffect(()=>{xe.language!==n&&xe.changeLanguage(n)},[n]);{const s=Rs(),[r,i]=h.useState(s.pathname);h.useEffect(()=>{const a=s.pathname;a!==r&&(i(a+s.search),nt(a,document.title,r))},[s,r])}return e.jsxs(e.Fragment,{children:[e.jsx(Xe,{children:e.jsx("title",{children:t})}),e.jsx(wn,{}),e.jsx("main",{children:e.jsxs(Vt,{children:[e.jsx(ss,{index:!0,element:e.jsx(Er,{})}),e.jsx(ss,{path:"/about",element:e.jsx(qn,{})}),e.jsx(ss,{path:"/help",element:e.jsx(Wn,{})}),e.jsx(ss,{path:"/stats/:categoryId?",element:e.jsx(Kr,{})})]})}),e.jsx(fn,{})]})}window.MyAggregator=window.MyAggregator||{};window._paq=window._paq||[];const Qr=["DEPLOY_PATH","API_URL","APP_TITLE","APP_TITLE_HEAD","MATOMO_TRACKING_PARAMS"];function Gr(){window.MyAggregator.DEPLOY_PATH!==void 0&&G.getState().setDeployPath(window.MyAggregator.DEPLOY_PATH),window.MyAggregator.API_URL!==void 0&&G.getState().setApiURL(window.MyAggregator.API_URL),window.MyAggregator.VALIDATOR_URL!==void 0&&G.getState().setValidatorURL(window.MyAggregator.VALIDATOR_URL),window.MyAggregator.SHOW_SEARCH_RESULT_LINK!==void 0&&G.getState().setShowSearchResultLink(window.MyAggregator.SHOW_SEARCH_RESULT_LINK),window.MyAggregator.APP_TITLE!==void 0&&G.getState().setAppTitle(window.MyAggregator.APP_TITLE),window.MyAggregator.APP_TITLE_HEAD!==void 0&&G.getState().setAppTitleHead(window.MyAggregator.APP_TITLE_HEAD),window.MyAggregator.MATOMO_TRACKING_PARAMS!==void 0&&G.getState().setMatomoTrackingParams(window.MyAggregator.MATOMO_TRACKING_PARAMS),window.MyAggregator.AUTH_USERNAME!==void 0&&G.getState().setAuthUsername(window.MyAggregator.AUTH_USERNAME),window.MyAggregator=new Proxy(window.MyAggregator,{get(t,n){return t[n]},set(t,n,s){return Qr.includes(n)?(console.error(`Configuration ${n} can only be set on initialization!`),!1):n==="VALIDATOR_URL"?s===null||typeof s=="string"?(G.getState().setValidatorURL(s),!0):!1:n==="SHOW_SEARCH_RESULT_LINK"?typeof s=="boolean"?(G.getState().setShowSearchResultLink(s),!0):!1:n==="AUTH_USERNAME"?s===null||typeof s=="string"?(G.getState().setAuthUsername(s),!0):!1:(t[n]=s,!0)}}),Object.assign(window.MyAggregator,{getAppStore:()=>G})}function Yr(){const t=ne.getState(),n=[navigator.language,...navigator.languages];let s=!1;for(const r of n){if(r===t.locale){s=!0;break}if(t.locales.includes(r)){t.setLocale(r),s=!0;break}}s||console.warn("User locale",n,"was not found in available languages",t.locales),Object.assign(window.MyAggregator,{getLocaleStore:()=>ne})}Gr();Yr();G.getInitialState(),G.getState();ne.getInitialState(),ne.getState();const Xr=G.getState().deployPath,Jr=G.getState().apiURL,Zr=ne.getState().locale;xe.changeLanguage(Zr);const ei=new $t({defaultOptions:{queries:{}}}),si=zt.create({baseURL:Jr,timeout:5e3,responseType:"json",transitional:{silentJSONParsing:!1}});{const t=G.getState().matomoTrackingParams;Dn(t)||console.warn("Unable to setup tracking ...")}const ti="root",ni=document.getElementById(ti),ri=nn.createRoot(ni);ri.render(e.jsx(h.StrictMode,{children:e.jsx(Gn,{axios:si,children:e.jsx(Kt,{client:ei,children:e.jsx(Wt,{children:e.jsx(Qt,{basename:Xr,children:e.jsx(Wr,{})})})})})}));export{vt as C,Vn as b,ys as f,ut as h,$n as p,zn as r,yt as u,Kn as x};
